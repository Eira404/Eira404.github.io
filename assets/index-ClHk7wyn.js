import{_ as te,a as le,b as ne}from"./console.vue_vue_type_style_index_0_lang-BTsus7Ju.js";import{a4 as M,w as _,z as $,a5 as X,a6 as z,a7 as S,a8 as h,az as Y,aa as b,aj as T,a9 as R,aW as P,aS as K,aT as U,ab as ae,ac as d,al as c,ap as Z,ad as w,an as N,ay as oe,at as q,as as O,aD as D,ak as H,aG as G,aX as se,aY as j,aZ as ie,a_ as B,a$ as re,x as ue,ar as de}from"./vendor-lsvYFlz-.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{m as W,u as pe,a as ve}from"./index-xOQeeRiY.js";import"./index.vue_vue_type_script_setup_true_lang-DOJkVeVG.js";import"./@codemirror-CRYCp3tI.js";import"./@pixi-BVfLF5Lp.js";import"./typescript-BEKa3Ftb.js";import"./echarts-Cx3wvM_t.js";import"./zrender-DxEpQaPd.js";import"./katex-CYndhgSo.js";const me=["aria-orientation","aria-grabbed"],fe=M({__name:"index",props:{direction:{default:"horizontal"},modelValue:{default:.5},minA:{default:80},minB:{default:80},gutter:{default:4},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","change","drag-start","drag-end"],setup(k,{emit:x}){const s=k,f=x,v=_(null),l=_(Math.min(.95,Math.max(.05,s.modelValue))),n=_(!1),u=$(()=>s.direction==="horizontal"),y=$(()=>({"split-container":!0,"is-horizontal":u.value,"is-vertical":!u.value,"is-dragging":n.value})),i=$(()=>({flexBasis:`calc(${l.value*100}% - ${s.gutter/2}px)`})),m=$(()=>({flexBasis:`calc(${(1-l.value)*100}% - ${s.gutter/2}px)`})),A=$(()=>({[u.value?"width":"height"]:`${s.gutter}px`,[u.value?"height":"width"]:"100%",cursor:u.value?"col-resize":"row-resize"}));let F=null;function L(p){if(s.disabled||!v.value)return;n.value=!0,p.currentTarget.setPointerCapture?.(p.pointerId),f("drag-start");const a=v.value.getBoundingClientRect(),g=u.value?a.width:a.height,C=s.minA??0,r=s.minB??0,e=I=>{if(!v.value)return;const E=u.value?I.clientX-a.left:I.clientY-a.top,V=Math.max(C/g,0),ee=1-Math.max(r/g,0),J=Math.min(ee,Math.max(V,E/g));J!==l.value&&(l.value=J,f("update:modelValue",l.value))},o=()=>{n.value=!1,f("drag-end"),f("change",l.value),window.removeEventListener("pointermove",e),window.removeEventListener("pointerup",o),F=null};window.addEventListener("pointermove",e,{passive:!0}),window.addEventListener("pointerup",o,{passive:!0}),F=()=>{window.removeEventListener("pointermove",e),window.removeEventListener("pointerup",o)}}X(()=>{l.value=t(s.modelValue)}),z(()=>{F?.()});function t(p){return Math.min(.98,Math.max(.02,p))}return(p,a)=>(h(),S("div",{ref_key:"container",ref:v,class:Y(y.value),role:"group","aria-label":"Split Pane"},[b("div",{class:"pane pane-a",style:R(i.value)},[T(p.$slots,"a",{},void 0,!0)],4),b("div",{class:"gutter bg-bg-dark/20 dark:bg-bg/20",style:R(A.value),"aria-orientation":u.value?"vertical":"horizontal","aria-grabbed":n.value?"true":"false",tabindex:"0",onPointerdown:L,onKeydown:a[0]||(a[0]=P(g=>{if(p.disabled)return;const C=g.shiftKey?.05:.01;if(u.value&&(g.key==="ArrowLeft"||g.key==="ArrowRight")){const r=g.key==="ArrowLeft"?-C:C,e=t(l.value+r);l.value=e,p.$emit("update:modelValue",l.value),p.$emit("change",l.value)}else if(!u.value&&(g.key==="ArrowUp"||g.key==="ArrowDown")){const r=g.key==="ArrowUp"?-C:C,e=t(l.value+r);l.value=e,p.$emit("update:modelValue",l.value),p.$emit("change",l.value)}},["prevent","stop"]))},null,44,me),b("div",{class:"pane pane-b",style:R(m.value)},[T(p.$slots,"b",{},void 0,!0)],4)],2))}}),Q=ce(fe,[["__scopeId","data-v-af4caa89"]]),ge={class:"h-full"},ye={class:"h-8 flex gap-1 justify-between items-center px-2"},we={style:{height:"calc(100% - 2rem)"},class:"flex flex-col"},be=["onClick"],ke=["onClick"],_e={class:"text-[12px]"},xe={class:"dialog-footer"},Ce={class:"dialog-footer"},he=M({__name:"fileList",props:{files:{type:Array,required:!0},filesModifiers:{},selectedFile:{type:String,required:!0},selectedFileModifiers:{}},emits:K(["addFile","deleteFile"],["update:files","update:selectedFile"]),setup(k,{emit:x}){const s=U(k,"files"),f=U(k,"selectedFile"),v=x,l=_(!1),n=_(""),u=()=>{n.value="",l.value=!0},y=()=>{if(!n.value){W("请输入文件名");return}if(s.value.includes(n.value)){W("文件已存在");return}if(n.value.includes("/")||n.value.includes("\\")||n.value.includes(" ")){W("文件名不能包含 / \\ 空格");return}v("addFile","/"+n.value.trim()),l.value=!1},i=_(!1),m=_(""),A=L=>{m.value=L,i.value=!0},F=()=>{v("deleteFile",m.value),i.value=!1};return(L,t)=>{const p=ae("router-link");return h(),S("div",ge,[b("div",ye,[d(p,{to:{name:"playground"},class:"text-[12px]"},{default:c(()=>t[5]||(t[5]=[Z(" HTML Playground ",-1)])),_:1,__:[5]}),d(w(N),{size:20,class:"cursor-pointer",title:"新建文件",onClick:u},{default:c(()=>[d(w(oe))]),_:1})]),b("div",we,[(h(!0),S(q,null,O(s.value,a=>(h(),S("div",{key:a,class:Y(["py-1 px-3 flex justify-between items-center hover:cursor-pointer hover:bg-gray-600/10 dark:hover:bg-gray-400/10",{"bg-gray-600/10 dark:hover:bg-gray-400/10":a===f.value}]),onClick:g=>f.value=a},[b("span",null,H(a.slice(1)),1),D(b("span",{onClick:P(g=>A(a),["stop"])},[d(w(N),{size:20},{default:c(()=>[d(w(se))]),_:1})],8,ke),[[G,a!=="/index.ts"]]),D(b("span",_e,"run 入口文件",512),[[G,a==="/index.ts"]])],10,be))),128))]),d(w(j),{modelValue:l.value,"onUpdate:modelValue":t[2]||(t[2]=a=>l.value=a),title:"Add File",width:"400px"},{footer:c(()=>[b("span",xe,[d(w(B),{onClick:t[1]||(t[1]=a=>l.value=!1)},{default:c(()=>t[6]||(t[6]=[Z("Cancel",-1)])),_:1,__:[6]}),d(w(B),{type:"primary",onClick:y},{default:c(()=>t[7]||(t[7]=[Z(" Confirm ",-1)])),_:1,__:[7]})])]),default:c(()=>[d(w(ie),{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=a=>n.value=a),placeholder:"请输入ts文件名"},null,8,["modelValue"])]),_:1},8,["modelValue"]),d(w(j),{modelValue:i.value,"onUpdate:modelValue":t[4]||(t[4]=a=>i.value=a),title:"Delete File",width:"400px"},{footer:c(()=>[b("span",Ce,[d(w(B),{onClick:t[3]||(t[3]=a=>i.value=!1)},{default:c(()=>t[8]||(t[8]=[Z("Cancel",-1)])),_:1,__:[8]}),d(w(B),{type:"primary",onClick:F},{default:c(()=>t[9]||(t[9]=[Z(" Confirm ",-1)])),_:1,__:[9]})])]),default:c(()=>[b("span",null,"你确定要删除文件"+H(m.value.slice(1))+"吗？",1)]),_:1},8,["modelValue"])])}}}),Fe={class:"h-full"},Ie={class:"h-full"},Se=["onClick"],Ae=["onClick"],Ve=M({__name:"code",props:K({title:{type:String,required:!0}},{code:{required:!0,type:String},codeModifiers:{},openedFiles:{type:Array,required:!0},openedFilesModifiers:{},selectedFile:{type:String,required:!0},selectedFileModifiers:{}}),emits:K(["run"],["update:code","update:openedFiles","update:selectedFile"]),setup(k,{emit:x}){const s=U(k,"code"),f=U(k,"openedFiles"),v=U(k,"selectedFile"),l=x,n=()=>{l("run")},u=y=>{const i=f.value.indexOf(y);f.value=f.value.filter(m=>m!==y),v.value===y&&(v.value=f.value[i-1])};return(y,i)=>(h(),S("div",Fe,[b("div",Ie,[d(te,{code:s.value,"onUpdate:code":i[0]||(i[0]=m=>s.value=m),lang:"ts",title:k.title},{"header-left":c(()=>[(h(!0),S(q,null,O(f.value,m=>(h(),S("div",{key:m,class:Y(["px-2 py-1 flex items-center gap-2 hover:cursor-pointer bg-bg dark:bg-bg-dark",{"text-moonlight-500 !bg-[#fcfcfc] dark:!bg-[#282c34]":m===v.value}]),onClick:A=>v.value=m},[b("span",null,H(m.slice(1)),1),D(b("span",{class:"flex items-center",onClick:P(A=>u(m),["stop"])},[d(w(N),{size:20},{default:c(()=>[d(w(re))]),_:1})],8,Ae),[[G,m!=="/index.ts"]])],10,Se))),128))]),"header-right":c(()=>[d(w(B),{plain:"",size:"small",onClick:n},{default:c(()=>i[1]||(i[1]=[Z("Run",-1)])),_:1,__:[1]})]),_:1},8,["code","title"])])]))}});function $e(k,x){const s=document.createElement("iframe");s.setAttribute("sandbox","allow-scripts allow-same-origin"),s.src="about:blank",s.style.display="none",document.body.appendChild(s);const f=new Blob([`const send=(type,args)=>parent.postMessage({type,args},'*');
const origLog=console.log;console.log=(...a)=>{send('log',a);origLog(...a)};
`],{type:"text/javascript"}),v=URL.createObjectURL(f),l=u=>x?.(u.data);window.addEventListener("message",l);const n=()=>{const u=s.contentDocument||s.contentWindow?.document;if(!u){x?.({type:"error",message:"Sandbox not ready: contentDocument is null"});return}u.open(),u.write(`<script src="${v}"><\/script>
<script type="module">
${k}
window.addEventListener('error',e=>parent.postMessage({type:'error',message:e.message},'*'));
parent.postMessage({type:'done'},'*');
<\/script>`),u.close()};return s.contentDocument?.readyState==="complete"?n():s.addEventListener("load",n,{once:!0}),()=>{window.removeEventListener("message",l),URL.revokeObjectURL(v),s.remove()}}const Le={class:"h-full overflow-hidden"},Ze=M({__name:"index",setup(k){const f=pe().tsPlayground.selectedExampleFiles.value,v=_(.15),l=_(.7),n=_(f),u=$({get:()=>Object.keys(n.value),set:r=>{n.value=r.reduce((e,o)=>(e[o]=n.value[o]||"",e),{})}}),y=_([]),i=_("");ue(i,r=>{y.value.includes(r)||y.value.push(r)}),i.value="/index.ts";const m=r=>{n.value[r]="",i.value=r},A=r=>{delete n.value[r],y.value=y.value.filter(e=>e!==r),i.value===r&&(i.value="/index.ts")},F=$({get:()=>n.value[i.value]||"",set:r=>{n.value[i.value]=r}}),L=new URL("data:video/mp2t;base64,aW1wb3J0IHsgYnVuZGxlIH0gZnJvbSAnLi9idWlsZCcNCg0Kc2VsZi5vbm1lc3NhZ2UgPSBhc3luYyAoZTogTWVzc2FnZUV2ZW50KSA9PiB7DQogIGNvbnN0IHsgdHlwZSwgZmlsZU1hcCwgZW50cnkgfSA9IGUuZGF0YSA/PyB7fQ0KICBpZiAodHlwZSA9PT0gJ2J1bmRsZScpIHsNCiAgICB0cnkgew0KICAgICAgY29uc3QgY29kZSA9IGF3YWl0IGJ1bmRsZShmaWxlTWFwLCBlbnRyeSk7DQogICAgICAoc2VsZiBhcyBhbnkpLnBvc3RNZXNzYWdlKHsgdHlwZTogJ2J1bmRsZTpvaycsIHBheWxvYWQ6IHsgY29kZSB9fSkNCiAgICB9IGNhdGNoIChlcnI6IGFueSkgew0KICAgICAgKHNlbGYgYXMgYW55KS5wb3N0TWVzc2FnZSh7IHR5cGU6ICdidW5kbGU6ZXJyJywgZXJyb3I6IFN0cmluZyhlcnI/Lm1lc3NhZ2UgfHwgZXJyKSB9KQ0KICAgIH0NCiAgfQ0KfQ0K",import.meta.url);let t=null;const p=_([]);function a(r,...e){const o=e.map(I=>typeof I=="string"?I:JSON.stringify(I)).join(" ");p.value.push({level:r,text:o,t:Date.now()})}const g=async()=>{if(!t)return;p.value=[];const r=ve(n.value);t.postMessage({type:"bundle",fileMap:r,entry:"/index.ts"})};let C=null;return X(()=>{t=new Worker(L,{type:"module"}),t.onmessage=async e=>{const{type:o,payload:I,error:E}=e.data??{};o==="bundle:ok"?(C?.(),C=$e(I.code,V=>{V?.type==="log"?a("log",...V.args):V?.type==="error"?a("error",V.message):V?.type==="done"&&a("info","[Program finished]")})):o==="bundle:err"&&a("error",E??"unknown error")};const r=e=>{(e.ctrlKey||e.metaKey)&&e.key.toLowerCase()==="enter"&&(e.preventDefault(),g())};window.addEventListener("keydown",r),g(),z(()=>{window.removeEventListener("keydown",r)})}),z(()=>{C?.(),t?.terminate(),t=null}),(r,e)=>(h(),S("div",Le,[d(Q,{modelValue:v.value,"onUpdate:modelValue":e[7]||(e[7]=o=>v.value=o),"min-a":20,"min-b":20},{a:c(()=>[d(he,{files:u.value,"onUpdate:files":e[0]||(e[0]=o=>u.value=o),"selected-file":i.value,"onUpdate:selectedFile":e[1]||(e[1]=o=>i.value=o),onAddFile:m,onDeleteFile:A},null,8,["files","selected-file"])]),b:c(()=>[d(Q,{modelValue:l.value,"onUpdate:modelValue":e[6]||(e[6]=o=>l.value=o),"min-a":20,"min-b":20,direction:"vertical"},{a:c(()=>[d(Ve,{"opened-files":y.value,"onUpdate:openedFiles":e[2]||(e[2]=o=>y.value=o),code:F.value,"onUpdate:code":e[3]||(e[3]=o=>F.value=o),"selected-file":i.value,"onUpdate:selectedFile":e[4]||(e[4]=o=>i.value=o),title:i.value.slice(1),onRun:g},null,8,["opened-files","code","selected-file","title"])]),b:c(()=>[d(le,{logs:p.value,"onUpdate:logs":e[5]||(e[5]=o=>p.value=o)},null,8,["logs"])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]))}}),Ge=M({__name:"index",setup(k){return(x,s)=>(h(),de(ne,null,{main:c(()=>[d(Ze)]),_:1}))}});export{Ge as default};
//# sourceMappingURL=index-ClHk7wyn.js.map
