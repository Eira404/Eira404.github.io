import{_ as te,a as le,b as ne}from"./console.vue_vue_type_style_index_0_lang-BcB1u4Bv.js";import{D as A,b as x,d as U,F as X,G as P,I as L,J as $,ab as N,N as b,W as G,K as z,ay as W,au as j,av as B,O as ae,P as d,Y as c,a1 as E,Q as w,$ as I,aa as oe,a5 as Y,a4 as Q,af as q,X as K,ai as O,az as se,aA as H,aB as ie,aC as S,aD as re,w as ue,a3 as de}from"./vendor-Cgv2NQ8W.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{m as R,u as pe,a as ve}from"./index-C0BRAMKf.js";import"./index.vue_vue_type_script_setup_true_lang-DGOEfTCQ.js";import"./katex-S9ZM2IJj.js";import"./typescript-CUSX335q.js";import"./echarts-CyEgZDPw.js";import"./zrender-BMBjG4B0.js";const me=["aria-orientation","aria-grabbed"],fe=A({__name:"index",props:{direction:{default:"horizontal"},modelValue:{default:.5},minA:{default:80},minB:{default:80},gutter:{default:4},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","change","drag-start","drag-end"],setup(_,{emit:F}){const s=_,f=F,v=x(null),l=x(Math.min(.95,Math.max(.05,s.modelValue))),a=x(!1),u=U(()=>s.direction==="horizontal"),y=U(()=>({"split-container":!0,"is-horizontal":u.value,"is-vertical":!u.value,"is-dragging":a.value})),i=U(()=>({flexBasis:`calc(${l.value*100}% - ${s.gutter/2}px)`})),m=U(()=>({flexBasis:`calc(${(1-l.value)*100}% - ${s.gutter/2}px)`})),V=U(()=>({[u.value?"width":"height"]:`${s.gutter}px`,[u.value?"height":"width"]:"100%",cursor:u.value?"col-resize":"row-resize"}));let C=null;function k(p){if(s.disabled||!v.value)return;a.value=!0,p.currentTarget.setPointerCapture?.(p.pointerId),f("drag-start");const r=v.value.getBoundingClientRect(),g=u.value?r.width:r.height,o=s.minA??0,e=s.minB??0,t=D=>{if(!v.value)return;const M=u.value?D.clientX-r.left:D.clientY-r.top,Z=Math.max(o/g,0),ee=1-Math.max(e/g,0),T=Math.min(ee,Math.max(Z,M/g));T!==l.value&&(l.value=T,f("update:modelValue",l.value))},h=()=>{a.value=!1,f("drag-end"),f("change",l.value),window.removeEventListener("pointermove",t),window.removeEventListener("pointerup",h),C=null};window.addEventListener("pointermove",t,{passive:!0}),window.addEventListener("pointerup",h,{passive:!0}),C=()=>{window.removeEventListener("pointermove",t),window.removeEventListener("pointerup",h)}}X(()=>{l.value=n(s.modelValue)}),P(()=>{C?.()});function n(p){return Math.min(.98,Math.max(.02,p))}return(p,r)=>($(),L("div",{ref_key:"container",ref:v,class:N(y.value),role:"group","aria-label":"Split Pane"},[b("div",{class:"pane pane-a",style:z(i.value)},[G(p.$slots,"a",{},void 0,!0)],4),b("div",{class:"gutter bg-bg-dark/20 dark:bg-bg/20",style:z(V.value),"aria-orientation":u.value?"vertical":"horizontal","aria-grabbed":a.value?"true":"false",tabindex:"0",onPointerdown:k,onKeydown:r[0]||(r[0]=W(g=>{if(p.disabled)return;const o=g.shiftKey?.05:.01;if(u.value&&(g.key==="ArrowLeft"||g.key==="ArrowRight")){const e=g.key==="ArrowLeft"?-o:o,t=n(l.value+e);l.value=t,p.$emit("update:modelValue",l.value),p.$emit("change",l.value)}else if(!u.value&&(g.key==="ArrowUp"||g.key==="ArrowDown")){const e=g.key==="ArrowUp"?-o:o,t=n(l.value+e);l.value=t,p.$emit("update:modelValue",l.value),p.$emit("change",l.value)}},["prevent","stop"]))},null,44,me),b("div",{class:"pane pane-b",style:z(m.value)},[G(p.$slots,"b",{},void 0,!0)],4)],2))}}),J=ce(fe,[["__scopeId","data-v-af4caa89"]]),ge={class:"h-full"},ye={class:"h-8 flex gap-1 justify-between items-center px-2"},we={style:{height:"calc(100% - 2rem)"},class:"flex flex-col"},be=["onClick"],_e=["onClick"],xe={class:"text-[12px]"},ke={class:"dialog-footer"},Fe={class:"dialog-footer"},he=A({__name:"fileList",props:{files:{type:Array,required:!0},filesModifiers:{},selectedFile:{type:String,required:!0},selectedFileModifiers:{}},emits:j(["addFile","deleteFile"],["update:files","update:selectedFile"]),setup(_,{emit:F}){const s=B(_,"files"),f=B(_,"selectedFile"),v=F,l=x(!1),a=x(""),u=()=>{a.value="",l.value=!0},y=()=>{if(!a.value){R("请输入文件名");return}if(s.value.includes(a.value)){R("文件已存在");return}if(a.value.includes("/")||a.value.includes("\\")||a.value.includes(" ")){R("文件名不能包含 / \\ 空格");return}v("addFile","/"+a.value.trim()),l.value=!1},i=x(!1),m=x(""),V=k=>{m.value=k,i.value=!0},C=()=>{v("deleteFile",m.value),i.value=!1};return(k,n)=>{const p=ae("router-link");return $(),L("div",ge,[b("div",ye,[d(p,{to:{name:"playground"},class:"text-[12px]"},{default:c(()=>n[5]||(n[5]=[E(" HTML Playground ",-1)])),_:1,__:[5]}),d(w(I),{size:20,class:"cursor-pointer",title:"新建文件",onClick:u},{default:c(()=>[d(w(oe))]),_:1})]),b("div",we,[($(!0),L(Y,null,Q(s.value,r=>($(),L("div",{key:r,class:N(["py-1 px-3 flex justify-between items-center hover:cursor-pointer hover:bg-gray-600/10 dark:hover:bg-gray-400/10",{"bg-gray-600/10 dark:hover:bg-gray-400/10":r===f.value}]),onClick:g=>f.value=r},[b("span",null,K(r.slice(1)),1),q(b("span",{onClick:W(g=>V(r),["stop"])},[d(w(I),{size:20},{default:c(()=>[d(w(se))]),_:1})],8,_e),[[O,r!=="/index.ts"]]),q(b("span",xe,"run 入口文件",512),[[O,r==="/index.ts"]])],10,be))),128))]),d(w(H),{modelValue:l.value,"onUpdate:modelValue":n[2]||(n[2]=r=>l.value=r),title:"Add File",width:"400px"},{footer:c(()=>[b("span",ke,[d(w(S),{onClick:n[1]||(n[1]=r=>l.value=!1)},{default:c(()=>n[6]||(n[6]=[E("Cancel",-1)])),_:1,__:[6]}),d(w(S),{type:"primary",onClick:y},{default:c(()=>n[7]||(n[7]=[E(" Confirm ",-1)])),_:1,__:[7]})])]),default:c(()=>[d(w(ie),{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=r=>a.value=r),placeholder:"请输入ts文件名"},null,8,["modelValue"])]),_:1},8,["modelValue"]),d(w(H),{modelValue:i.value,"onUpdate:modelValue":n[4]||(n[4]=r=>i.value=r),title:"Delete File",width:"400px"},{footer:c(()=>[b("span",Fe,[d(w(S),{onClick:n[3]||(n[3]=r=>i.value=!1)},{default:c(()=>n[8]||(n[8]=[E("Cancel",-1)])),_:1,__:[8]}),d(w(S),{type:"primary",onClick:C},{default:c(()=>n[9]||(n[9]=[E(" Confirm ",-1)])),_:1,__:[9]})])]),default:c(()=>[b("span",null,"你确定要删除文件"+K(m.value.slice(1))+"吗？",1)]),_:1},8,["modelValue"])])}}}),$e={class:"h-full"},Ce={class:"h-full"},Le=["onClick"],Ve=["onClick"],Me=A({__name:"code",props:j({title:{type:String,required:!0}},{code:{required:!0,type:String},codeModifiers:{},openedFiles:{type:Array,required:!0},openedFilesModifiers:{},selectedFile:{type:String,required:!0},selectedFileModifiers:{}}),emits:j(["run"],["update:code","update:openedFiles","update:selectedFile"]),setup(_,{emit:F}){const s=B(_,"code"),f=B(_,"openedFiles"),v=B(_,"selectedFile"),l=F,a=()=>{l("run")},u=y=>{const i=f.value.indexOf(y);f.value=f.value.filter(m=>m!==y),v.value===y&&(v.value=f.value[i-1])};return(y,i)=>($(),L("div",$e,[b("div",Ce,[d(te,{code:s.value,"onUpdate:code":i[0]||(i[0]=m=>s.value=m),lang:"ts",title:_.title},{"header-left":c(()=>[($(!0),L(Y,null,Q(f.value,m=>($(),L("div",{key:m,class:N(["px-2 py-1 flex items-center gap-2 hover:cursor-pointer bg-bg dark:bg-bg-dark",{"text-moonlight-500 !bg-[#fcfcfc] dark:!bg-[#282c34]":m===v.value}]),onClick:V=>v.value=m},[b("span",null,K(m.slice(1)),1),q(b("span",{class:"flex items-center",onClick:W(V=>u(m),["stop"])},[d(w(I),{size:20},{default:c(()=>[d(w(re))]),_:1})],8,Ve),[[O,m!=="/index.ts"]])],10,Le))),128))]),"header-right":c(()=>[d(w(S),{plain:"",size:"small",onClick:a},{default:c(()=>i[1]||(i[1]=[E("Run",-1)])),_:1,__:[1]})]),_:1},8,["code","title"])])]))}});function Ue(_,F){const s=document.createElement("iframe");s.setAttribute("sandbox","allow-scripts allow-same-origin"),s.src="about:blank",s.style.display="none",document.body.appendChild(s);const f=new Blob([`const send=(type,args)=>parent.postMessage({type,args},'*');
const origLog=console.log;console.log=(...a)=>{send('log',a);origLog(...a)};
`],{type:"text/javascript"}),v=URL.createObjectURL(f),l=u=>F?.(u.data);window.addEventListener("message",l);const a=()=>{const u=s.contentDocument||s.contentWindow?.document;if(!u){F?.({type:"error",message:"Sandbox not ready: contentDocument is null"});return}u.open(),u.write(`<script src="${v}"><\/script>
<script type="module">
${_}
window.addEventListener('error',e=>parent.postMessage({type:'error',message:e.message},'*'));
parent.postMessage({type:'done'},'*');
<\/script>`),u.close()};return s.contentDocument?.readyState==="complete"?a():s.addEventListener("load",a,{once:!0}),()=>{window.removeEventListener("message",l),URL.revokeObjectURL(v),s.remove()}}const Ee={class:"h-full overflow-hidden"},Se=A({__name:"index",setup(_){const f=pe().tsPlayground.selectedExampleFiles.value,v=x(.15),l=x(.7),a=x(f),u=U({get:()=>Object.keys(a.value),set:o=>{a.value=o.reduce((e,t)=>(e[t]=a.value[t]||"",e),{})}}),y=x([]),i=x("");ue(i,o=>{y.value.includes(o)||y.value.push(o)}),i.value="/index.ts";const m=o=>{a.value[o]="",i.value=o},V=o=>{delete a.value[o],y.value=y.value.filter(e=>e!==o),i.value===o&&(i.value="/index.ts")},C=U({get:()=>a.value[i.value]||"",set:o=>{a.value[i.value]=o}});let k=null;const n=x([]);function p(o,...e){const t=e.map(h=>typeof h=="string"?h:JSON.stringify(h)).join(" ");n.value.push({level:o,text:t,t:Date.now()})}const r=async()=>{if(!k)return;n.value=[];const o=ve(a.value);k.postMessage({type:"bundle",fileMap:o,entry:"/index.ts"})};let g=null;return X(()=>{k=new Worker(new URL("/assets/esbuild-worker-CzqB_wmo.js",import.meta.url),{type:"module"}),k.onmessage=async e=>{const{type:t,payload:h,error:D}=e.data??{};t==="bundle:ok"?(g?.(),g=Ue(h.code,M=>{M?.type==="log"?p("log",...M.args):M?.type==="error"?p("error",M.message):M?.type==="done"&&p("info","[Program finished]")})):t==="bundle:err"&&p("error",D??"unknown error")};const o=e=>{(e.ctrlKey||e.metaKey)&&e.key.toLowerCase()==="enter"&&(e.preventDefault(),r())};window.addEventListener("keydown",o),r(),P(()=>{window.removeEventListener("keydown",o)})}),P(()=>{g?.(),k?.terminate(),k=null}),(o,e)=>($(),L("div",Ee,[d(J,{modelValue:v.value,"onUpdate:modelValue":e[7]||(e[7]=t=>v.value=t),"min-a":20,"min-b":20},{a:c(()=>[d(he,{files:u.value,"onUpdate:files":e[0]||(e[0]=t=>u.value=t),"selected-file":i.value,"onUpdate:selectedFile":e[1]||(e[1]=t=>i.value=t),onAddFile:m,onDeleteFile:V},null,8,["files","selected-file"])]),b:c(()=>[d(J,{modelValue:l.value,"onUpdate:modelValue":e[6]||(e[6]=t=>l.value=t),"min-a":20,"min-b":20,direction:"vertical"},{a:c(()=>[d(Me,{"opened-files":y.value,"onUpdate:openedFiles":e[2]||(e[2]=t=>y.value=t),code:C.value,"onUpdate:code":e[3]||(e[3]=t=>C.value=t),"selected-file":i.value,"onUpdate:selectedFile":e[4]||(e[4]=t=>i.value=t),title:i.value.slice(1),onRun:r},null,8,["opened-files","code","selected-file","title"])]),b:c(()=>[d(le,{logs:n.value,"onUpdate:logs":e[5]||(e[5]=t=>n.value=t)},null,8,["logs"])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]))}}),Ke=A({__name:"index",setup(_){return(F,s)=>($(),de(ne,null,{main:c(()=>[d(Se)]),_:1}))}});export{Ke as default};
