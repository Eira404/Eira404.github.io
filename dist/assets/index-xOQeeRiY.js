const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DXjaoGI0.js","assets/index.vue_vue_type_script_setup_true_lang-DOJkVeVG.js","assets/vendor-lsvYFlz-.js","assets/@pixi-BVfLF5Lp.js","assets/typescript-BEKa3Ftb.js","assets/@codemirror-CRYCp3tI.js","assets/vendor-DkC2A9Vi.css","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/index-D12Xt8cF.css","assets/index-BMdWRKVK.js","assets/index.vue_vue_type_script_setup_true_lang-DV-gEiBH.js","assets/echarts-Cx3wvM_t.js","assets/zrender-DxEpQaPd.js","assets/katex-CYndhgSo.js","assets/index-Bsqk1qzD.js","assets/default.vue_vue_type_script_setup_true_lang-C8PBxAeO.js","assets/index-DRljjcBF.js","assets/index-DmDnxAE8.js","assets/index-CX77IQZr.js","assets/AboutView-CcMYqCNL.js","assets/index-B6WC_k1I.js","assets/index-DSAeinf7.js","assets/console.vue_vue_type_style_index_0_lang-BTsus7Ju.js","assets/console-CQjSrUKs.css","assets/index-ClHk7wyn.js","assets/index-DTx8Fzbg.css"])))=>i.map(i=>d[i]);
import{E as K,v as Le,w as I,x as J,y as G,z as D,A as re,B as Pe,C as ue,M as Ae,D as Ie,F as Fe,G as Ne,H as Be,J as je,K as B,L as Oe,O as Re,Q as we,R as qe,U as $e,V as Ve,W as ze,X as He,Y as Ge,Z as Ue,$ as Qe,a0 as Ye,a1 as Ke,a2 as We,a3 as Je,a4 as De,a5 as Xe,a6 as Ze,a7 as Se,a8 as Me,a9 as et,aa as de,ab as tt,ac as me,ad as st,ae as oe,af as it,ag as rt,ah as at,ai as nt}from"./vendor-lsvYFlz-.js";import{u as ot,i as lt,a as ct,b as ht,c as ut,d as dt,e as mt,f as ft}from"./echarts-Cx3wvM_t.js";import{M as _t}from"./katex-CYndhgSo.js";import{a as pt}from"./typescript-BEKa3Ftb.js";import{s as gt}from"./@pixi-BVfLF5Lp.js";import"./@codemirror-CRYCp3tI.js";import"./zrender-DxEpQaPd.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();const yt={Home:"首页",Microservice:"微服务",Testbed:"试验台",FaultInjection:"故障注入",Data:"数据",Dataset:"数据集",Algorithm:"算法",Template:"模板",Evaluation:"评估",Leaderboard:"Leaderboard"},vt={Deploy:"部署",Dialog:{TestbedName:"试验台名称",Description:"描述",Services:"服务",Cancel:"取消",Confirm:"确定"}},kt={Add:"增加",Name:"名字",Microservice:"微服务",Description:"描述",CreateTime:"创建时间",ServiceStatus:"运行状态",TrafficStatus:"流量状态",LoadStatus:"注入状态",Operations:"操作",Load:"注入",Stop:"停止",Delete:"删除",Usage:"已使用",Limit:"上限",Create:{Title:"创建注入",Cancel:"取消",Confirm:"确定"}},bt={CreateQueryTask:"创建查询任务",Filter:"筛选",All:"全部",SearchPrompt:"搜索详情、ID、pod name",Detail:"详情"},wt={Node:"机器",Pod:"服务",Machine:"机器指标"},Dt={CreateQueryTask:"创建查询任务",Sort:"排序",MostRecent:"最近",LongestFirst:"最久",ShortestFirst:"最短",All:"全部",SearchPrompt:"搜索业务名称、ID",GotoQueryTraceID:"跳转到查询调用链ID"},St={Click:"点击",LeftButon:"左侧按钮",Select:"来选择Metric Name",Back:"返回",SelectedType:"当前类型",Change:"切换",Node:"Node",Pod:"Pod",SelectMetricName:"选择 Metric Name",SelectTimeInterval:"选择时间范围",AddAll:"全部添加",RemoveAll:"全部移除",Add:"添加",Remove:"移除",Empty:"无查询结果"},Mt={Back:"返回",SearchPrompt:"输入需要搜索的Trace ID",Search:"搜索",ToData:"To data",Copy:"复制URL",NoData:"无数据"},Tt={Sidebar:{SelectData:"选择数据",NowNamespace:"当前Namespace",InputNamespace:"输入Namespace",Goto:"切换",YourNamespaces:"你的Namespaces",SelectType:"选择类型",NowType:"当前类型",YourTypes:"你的类型",Logs:"日志（Logs）",Metrics:"指标（Metrics）",Traces:"调用链（Traces）"},QueryTaskList:{QueryTaskList:"查询任务列表",NullQueryTask:"当前无查询任务",CreateQueryTask:"创建查询任务",Status:"状态",SelectATimeRange:"选择时间范围:",SelectEndTime:"选择结束时刻:",SelectEndTime2:"选择结束时刻",Cancel:"取消",Confirm:"确定"},Home:{ViewDetails:"查看详情",Logs:"查询日志数据",Metrics:"查询指标数据",Traces:"查询调用链数据",NullNamespace:"当前用户下无Namespace",Microservice:"微服务",Testbed:"试验台",Or:"或",PLSGoto:"请前往",LastS:"创建微服务系统以获取Namespace；",OINS:"或输入Namespace：",InputNamespace:"输入Namespace",Goto:"切换"},Logs:bt,Metrics:wt,Traces:Dt,Metric:St,Trace:Mt},Et={InjectionDialog:{Experiment:"Experiment",Schedule:"Schedule",Single:"单次，选择故障注入时刻",Timer:"定时，crontab表达式，北京时间，10 5 * * *",SelectInjectionTiming:"Select injection timing",Cancel:"取消",Confirm:"确认",Injection:"注入故障"},SelectFault:"选择需要注入的故障",Question:{Q1:"1. 按住V键的同时，向上（向下）滚动或按+（-）可垂直放大（缩小）日历",Q2:"2. 按住H键的同时，向上（向下）滚动或按+（-）可水平放大（缩小）日历",Q3:"3. 拖动滚动条、滚动滚轮，或按住日历并移动鼠标以移动日历"},AllFaultsAreLoaded:"故障信息获取完成",LoadingDates:"加载日期",RenderingCompleted:"渲染完成",ErrorDates:"报错日期",DetailDialog:{FaultDetail:"故障详情",Type:"类型",Delete:"删除",Name:"名称",Timestamp:"时间戳",Duration:"持续时间",Cancel:"取消",Warning:"警告",DeletePrompt:'你确定要<span class="text-red-500">删除</span>故障',Q:"吗？",Ongoing:"请勿删除正在执行的故障"},PleaseSelectANamespace:{Microservice:"微服务",Testbed:"试验台",Or:"或",PLSGoto:"请前往",LastS:"创建微服务系统以获取Namespace"}},Ct={PublicDatasets:"公开数据集",PrivateDatasets:"私有数据集",Refresh:"刷新",Create:{Create:"创建数据集",TimeRange:"时间区间",DatasetName:"数据集名称",Description:"数据集描述",Category:"包含数据情况",No:"无",Log:"Log",Metric:"Metric",MetricStep:"Metric 步长",Trace:"Trace",Visibility:"可见性",Visible:"公开",Invisible:"私有",Namespace:"Namespace",SelectNamespace:"选择 Namespace",Confirm:"确认",Cancel:"取消"},Download:"下载",Now:"当前",Visible:"公开",Invisible:"私有",Delete:"删除"},xt={Empty:"请填写完整信息",CodeSuccess:"验证发送成功",CodeFailure:"验证发送失败",CodeError:"验证码错误",PasswordNotMatch:"密码不一致",PlsEnterEmail:"请输入邮箱",Login:{Success:"登录成功",Failure:"登陆失败"},Register:{Success:"注册成功",Failure:"注册失败",UsernameExisted:"用户名已存在",EmailExisted:"邮箱已存在"},Retrieve:{Success:"修改密码成功",Failure:"修改密码失败"}},Lt={Create:{Success:"正在部署",Failure:"部署失败",Running:"部署成功"},Delete:{Success:"正在成功",Failure:"删除失败",Finish:"删除成功"}},Pt={Create:{Success:"开始注入流量",Failure:"流量注入失败"},Delete:{Success:"停止注入流量",Failure:"停止注入失败"}},At={Delete:{Success:"删除成功，请等待渲染更新",Failure:"删除失败"},Inject:{Success:"注入成功，请等待渲染更新",Failure:"注入失败"},Dialog:{Empty:"不能为空",LessThanNow:"不能早于当前时刻"}},It={Create:{Success:"创建数据集成功",Failure:"创建数据集失败"},Delete:{Success:"删除数据集成功",Failure:"删除数据集失败"},ChangeVisibility:{Success:"成功修改数据集可见性",Failure:"修改数据集可见性失败"}},Ft={Visitor:xt,Testbed:Lt,Load:Pt,FaultManager:At,Dataset:It},Nt={Nav:yt,Microservice:vt,Testbed:kt,Data:Tt,FaultInjection:Et,Dataset:Ct,Madison:Ft},Bt={Home:"Home",Microservice:"Microservice",Testbed:"Testbed",FaultInjection:"FaultInjection",Data:"Data",Dataset:"Dataset",Algorithm:"Algorithm",Template:"Template",Evaluation:"Evaluation",Leaderboard:"Leaderboard"},jt={Deploy:"Deploy",Dialog:{TestbedName:"Testbed Name",Description:"Description",Services:"Services",Cancel:"Cancel",Confirm:"Confirm"}},Ot={Add:"Add",Name:"Name",Microservice:"Microservice",Description:"Description",CreateTime:"CreateTime",ServiceStatus:"ServiceStatus",TrafficStatus:"TrafficStatus",LoadStatus:"LoadStatus",Operations:"Operations",Load:"Load",Stop:"Stop",Delete:"Delete",Usage:"Usage",Limit:"Limit",Create:{Title:"Create load",Cancel:"Cancel",Confirm:"Confirm"}},Rt={CreateQueryTask:"Create Query Task",Filter:"Filter",All:"All",SearchPrompt:"Search msg、ID、pod name",Detail:"Detail"},qt={Node:"Node",Pod:"Pod",Machine:"Machine"},$t={CreateQueryTask:"CreateQueryTask",Sort:"Sort",MostRecent:"Most Recent",LongestFirst:"Longest First",ShortestFirst:"Shortest First",All:"All",SearchPrompt:"Search operation name、trace ID",GotoQueryTraceID:"Goto Query Trace ID"},Vt={Click:"Click the",LeftButon:"left button",Select:"to select metric name",Back:"Back",SelectedType:"Selected type",Change:"Change",Node:"Node",Pod:"Pod",SelectMetricName:"Select metric name",SelectTimeInterval:"Select time interval",AddAll:"Add all",RemoveAll:"Remove all",Add:"Add",Remove:"Remove",Empty:"Empty query result"},zt={Back:"Back",SearchPrompt:"Input Trace ID",Search:"Search",ToData:"To data",Copy:"Copy URL",NoData:"No data"},Ht={Sidebar:{SelectData:"Select Data",NowNamespace:"Now Namespace",InputNamespace:"Input Namespace",Goto:"Goto",YourNamespaces:"Your Namespaces",SelectType:"Select Type",NowType:"Now Type",YourTypes:"Your Types",Logs:"Logs",Metrics:"Metrics",Traces:"Traces"},QueryTaskList:{QueryTaskList:"Query Task List",NullQueryTask:"No query tasks",CreateQueryTask:"Create Query Task",Status:"Status",SelectATimeRange:"Select Range:",SelectEndTime:"Select End Time:",SelectEndTime2:"Select End Time",Cancel:"Cancel",Confirm:"Confirm"},Home:{ViewDetails:"View Details",Logs:"Query logs data",Metrics:"Query metrics data",Traces:"Query traces data",NullNamespace:"No namespaces found for the current user",Microservice:"Microservice",Testbed:"Testbed",Or:"or",PLSGoto:"Please goto",LastS:"to create a microservice system to obtain the namespace;",OINS:"Or input namespace:",InputNamespace:"Input Namespace",Goto:"Goto"},Logs:Rt,Metrics:qt,Traces:$t,Metric:Vt,Trace:zt},Gt={InjectionDialog:{Experiment:"Experiment",Schedule:"Schedule",Single:"Single time, select the fault injection time",Timer:"Timer, crontab expression, Beijing time, 10 5 * * *",SelectInjectionTiming:"Select injection timing",Cancel:"Cancel",Confirm:"Confirm",Injection:"Inject fault"},SelectFault:"Select fault",Question:{Q1:"1. While holding down V, scroll up (down) or press+(-) to vertically zoom in (down) on the calendar",Q2:"2. While holding down H, scroll up (down) or press+(-) to horizontally zoom in (down) on the calendar",Q3:"3. Drag the scrollbar or scroll wheel, or hold down the calendar and move the mouse to move the calendar"},AllFaultsAreLoaded:"All faults are loaded",LoadingDates:"Loading dates",RenderingCompleted:"Rendering completed",ErrorDates:"Error dates",DetailDialog:{FaultDetail:"Fault Detail",Type:"Type",Delete:"Delete",Name:"Name",Timestamp:"Timestamp",Duration:"Duration",Cancel:"Cancel",Warning:"Warning",DeletePrompt:'Are you sure you want to <span class="text-red-500">DELETE</span> fault',Q:"?",Ongoing:"Do not delete ongoing faults"},PleaseSelectANamespace:{Microservice:"Microservice",Testbed:"Testbed",Or:"or",PLSGoto:"Please goto",LastS:"to create a microservice system to obtain the namespace"}},Ut={PublicDatasets:"Public Datasets",PrivateDatasets:"Private Datasets",Refresh:"Refresh",Create:{Create:"Create Dataset",TimeRange:"Time Range",DatasetName:"Dataset Name",Description:"Description",Category:"Category",No:"No",Log:"Log",Metric:"Metric",MetricStep:"Metric Step",Trace:"Trace",Visibility:"Visibility",Visible:"Visible",Invisible:"Invisible",Namespace:"Namespace",SelectNamespace:"Select Namespace",Confirm:"Confirm",Cancel:"Cancel"},Download:"Download",Now:"Now",Visible:"Visible",Invisible:"Invisible",Delete:"Delete"},Qt={Empty:"Please complete all required fields",CodeSuccess:"Verification code sent",CodeFailure:"Failed to send verification code",CodeError:"Verification code error",PasswordNotMatch:"Passwords do not match",PlsEnterEmail:"Please enter your email",Login:{Success:"Login successful",Failure:"Login failed"},Register:{Success:"Registration successful",Failure:"Registration failed",UsernameExisted:"Username already exists",EmailExisted:"Email already exists"},Retrieve:{Success:"Password reset successful",Failure:"Password reset failed"}},Yt={Create:{Success:"Deploying",Failure:"Deployment failed",Running:"Deployment successful"},Delete:{Success:"Deleting",Failure:"Delete failed",Finish:"Delete successfully"}},Kt={Create:{Success:"Start injecting traffic",Failure:"Traffic injection failed"},Delete:{Success:"Stop injecting traffic",Failure:"Stop injection failed"}},Wt={Delete:{Success:"Deletion successful, please wait for rendering update",Failure:"Delete failed"},Inject:{Success:"Injection successful, please wait for rendering update",Failure:"Injection failed"},Dialog:{Empty:"can't be empty",LessThanNow:"can't be less than now"}},Jt={Create:{Success:"Dataset created successfully",Failure:"Failed to create dataset"},Delete:{Success:"Dataset deleted successfully",Failure:"Failed to delete dataset"},ChangeVisibility:{Success:"Dataset visibility updated successfully",Failure:"Failed to update dataset visibility"}},Xt={Visitor:Qt,Testbed:Yt,Load:Kt,FaultManager:Wt,Dataset:Jt},Zt={Nav:Bt,Microservice:jt,Testbed:Ot,Data:Ht,FaultInjection:Gt,Dataset:Ut,Madison:Xt},es={"zh-CN":Nt,"en-US":Zt};class ts{static getQueryData(e,t){const s=[];return t.forEach(i=>{s.push([i,e.query[i]])}),s}static checkQueryData(e,t,s){return!1}__promises=[];__checkFunctions=[];__precheckFunctions=[];__postcheckFunctions=[];router;constructor(e){this.router=e}addCheck(e,t,s=0){const i={func:e,context:t,level:s};this.__checkFunctions.push(i),this.__checkFunctions.sort((r,a)=>r.level-a.level)}addPrecheck(e,t,s=0){const i={func:e,context:t,level:s};this.__precheckFunctions.push(i),this.__precheckFunctions.sort((r,a)=>r.level-a.level)}addPostcheck(e,t,s=0){const i={func:e,context:t,level:s};this.__postcheckFunctions.push(i),this.__postcheckFunctions.sort((r,a)=>r.level-a.level)}removeCheck(e,t){this.__checkFunctions=this.__checkFunctions.filter(s=>s.func!==e||s.context!==t)}removePrecheck(e,t){this.__precheckFunctions=this.__precheckFunctions.filter(s=>s.func!==e||s.context!==t)}removePostcheck(e,t){this.__postcheckFunctions=this.__postcheckFunctions.filter(s=>s.func!==e||s.context!==t)}addPromise(e){this.__promises.push(e)}async check(e,t,s){this.__checkFunctions.forEach(i=>{this.__promises.push(i.func.call(i.context,e,t))});try{const i=await Promise.all(this.__promises);for(let r=0;r<i.length;r++){const a=i[r];if(a)return this.__promises=[],s(a),!1}}catch(i){throw new Error("Error "+i)}return!0}precheck(e,t,s){const i=[];return this.__precheckFunctions.forEach(r=>{i.push(r.func.call(r.context,e,t))}),this.syncFuncCheck(i,s)}postcheck(e,t){this.__postcheckFunctions.forEach(s=>{s.func.call(s.context,e,t)}),this.__promises=[]}syncFuncCheck(e,t){for(let s=0;s<e.length;s++){const i=e[s];if(i){if(i[0]==="success")continue;if(i[0]==="redirect")return t(i[1]),!1}}return!0}}function X(n,e,t,s){switch(s=s||"default",s=s.toLocaleLowerCase(),e!=null&&window.localStorage.getItem(n)===null&&Y(n,e,s),s){case"default":return window.localStorage.getItem(n);case"json":return JSON.parse(window.localStorage.getItem(n)||"");default:throw new Error(`不可接受的type:${s}`)}}function Y(n,e,t){switch(t=t||"default",t=t.toLocaleLowerCase(),t){case"default":return window.localStorage.setItem(n,e);case"json":return window.localStorage.setItem(n,JSON.stringify(e).toString());default:throw new Error(`不可接受的type:${t}`)}}class ss extends Map{capacity;deleteCallback;constructor(e,t){super(),this.capacity=e||100,this.deleteCallback=t||null}set(e,t){return this.has(e)?this.delete(e):this.size>=this.capacity&&this.delete(this.keys().next().value),super.set(e,t)}get(e){if(this.has(e)){const t=super.get(e);return super.delete(e),super.set(e,t),t}else return}delete(e){return this.deleteCallback&&this.has(e)&&this.deleteCallback(e,super.get(e)),super.delete(e)}}const Te={childrenEvent:!1,rewrite:!1};class le{__selector;__element;__eventMap=new Map;__optionsMap=new Map;get element(){return this.__element}get size(){return this.__eventMap.size}constructor(e,t){this.__selector=e,this.__element=t}getKey(e,t,s){return{select:e,event:t,trigger:s}}createEventCallback(e,t,s,i){return a=>{a.target!==this.__element&&!i.childrenEvent||(a.preventDefault(),this.__selector.onEvent(this.__element,t,e,a,s))}}addEvent(e,t,s,i){i={...Te,...i};const r=this.getKey(e,t,s);if(this.__eventMap.has(r)&&!i.rewrite)return;const a=this.createEventCallback(e,t,s,i);this.__element.addEventListener(t,a),this.__eventMap.has(r)&&this.__element.removeEventListener(t,this.__eventMap.get(r)),this.__eventMap.set(r,a),this.__optionsMap.set(r,i)}removeEvent(e,t,s){const i=this.getKey(e,t,s),r=this.__eventMap.get(i);r&&this.__element.removeEventListener(t,r)}copySelectorItem(e){const t=new le(this.__selector,e);return Array.from(this.__eventMap.keys()).forEach(s=>{const i=this.__optionsMap.get(s);i&&t.addEvent(s.select,s.event,s.trigger,i)}),t}destroy(){Array.from(this.__eventMap.entries()).forEach(([e,t])=>{try{this.__element.removeEventListener(e.event,t)}catch(s){console.warn(s)}}),this.__eventMap.clear(),this.__optionsMap.clear()}}class is extends K{__selector2Options=new Map;__selector2Elements=new Map;__element2SelectorItem=new Map;__destroyed=!1;__root;__observer;__config;constructor(e,t,s){super();const i=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;this.__root=t||document.body,this.__observer=new i((r,a)=>{this.refresh()}),this.__config={childList:!0,subtree:!0,...s},this.__observer.observe(this.__root,this.__config),this.addSelectorList(e||[]),this.refresh()}onEvent(e,t,s,i,r){const a={element:e,event:t,select:s,e:i};this.emit(r,a)}getKey(e,t,s){return{select:e,event:t,trigger:s}}addSelectorList(e){e.forEach(t=>{const[s,i,r,a]=t,o={...Te,...a},c=this.getKey(i,s,r);this.__selector2Options.has(c)&&!o.rewrite||this.__selector2Options.set(c,o)}),this.refresh()}removeSelectorList(e){e.forEach(t=>{const[s,i,r]=t,a=this.getKey(i,s,r),o=this.__selector2Elements.get(a);o&&(new Set(o).forEach(c=>{const h=this.__element2SelectorItem.get(c);h?.removeEvent(i,s,r),h?.size===0&&(o.delete(c),h.destroy(),this.__element2SelectorItem.delete(c))}),this.__selector2Elements.delete(a),this.__selector2Options.delete(a))}),this.refresh()}select(){setTimeout(()=>{Array.from(this.__selector2Options.entries()).forEach(([t,s])=>{const i=Array.from(document.querySelectorAll(t.select)),r=new Set(this.__selector2Elements.get(t))||new Set;i.forEach(a=>{if(r.has(a)){s.rewrite&&this.__element2SelectorItem.get(a)?.addEvent(t.select,t.event,t.trigger,s),r.delete(a);return}const o=new le(this,a);o.addEvent(t.select,t.event,t.trigger,s),this.__element2SelectorItem.set(a,o)}),r.forEach(a=>{this.__element2SelectorItem.get(a)?.destroy(),this.__element2SelectorItem.delete(a)}),this.__selector2Elements.set(t,new Set(i))})},0)}refresh(){this.select()}destroy(){this.__destroyed||(this.__destroyed=!0,Array.from(this.__element2SelectorItem.values()).forEach(e=>{e.destroy()}),this.__observer.disconnect(),this.__element2SelectorItem.clear(),this.__selector2Options.clear(),this.__selector2Elements.clear(),this.removeAllListeners())}}const rs={delete:!1};class as{t;name;interval;time;options;meta;state;timer;constructor(e,t,s,i,r,a){this.t=e,this.name=t,this.interval=s,this.time=i,this.options=r||{},this.meta=a||{},this.state=0,this.timer=null,this.check()?this.state=1:this.state=2}check(){return!(typeof this.interval!="boolean"||Number.isNaN(Number(this.time))||this.time<0||!Number.isInteger(this.time)||!_e(this.options)||!_e(this.meta))}start(e){this.time=e||this.time,this.timer!==null&&(this.interval?clearInterval(this.timer):clearTimeout(this.timer)),this.interval?this.timer=setInterval(this.callback.bind(this),this.time):this.timer=setTimeout(this.callback.bind(this),this.time),this.state=3}stop(){this.timer&&(this.interval?clearInterval(this.timer):clearTimeout(this.timer)),this.state=4}callback(){this.state=5;const e={meta:this.meta,data:{name:this.name,interval:this.interval,time:this.time}};this.t.emit(this.name,e),this.afterCallback()}afterCallback(){this.options.delete===!0&&this.t.delete(this.name)}destroy(){this.timer&&(this.interval?clearInterval(this.timer):clearTimeout(this.timer))}}class ns extends K{timerMap;constructor(){super(),this.timerMap=new Map}create(e="base",t=!0,s=0,i=rs,r={}){if(this.has(e))return!1;const a=new as(this,e,t,s,i,r);return a.state===2?!1:(this.timerMap.set(e,a),!0)}get(e){return this.timerMap.get(e)}getAll(){return Array.from(this.timerMap.entries())}has(e){return this.timerMap.has(e)}state(e){return this.has(e)?this.get(e)?.state:!1}start(e,t){if(!this.has(e))return!1;const s=this.get(e);return s===void 0||s.state===3?!1:(s.start(t),!0)}stop(e){return e instanceof Function?(this.getAll().forEach(s=>{e(s[0])===!0&&s[1].stop()}),!0):this.has(e)?(this.get(e)?.stop(),!0):!1}restart(e,t){return this.has(e)?(this.get(e)?.start(t),!0):!1}delete(e){return this.has(e)?(this.get(e)?.destroy(),this.timerMap.delete(e),!0):!1}destroy(){this.getAll().forEach(t=>{t[1].destroy()}),this.removeAllListeners()}}function fe(n,e,t){e=e||"error",t=t||(e==="error"?4e3:3e3),Le({message:n,type:e,duration:t})}function ae(n,e){function t(i){const r={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"};return i instanceof Element?"element":r[Object.prototype.toString.call(i)]||"unknown"}const s=t(n);if(s==="array"||s==="object"){e||(e=new WeakMap);const i=e.get(n);if(i)return i;if(s==="array"){const r=[];return n.forEach(a=>{r.push(ae(a,e))}),e.set(n,r),r}if(s==="object"){const r={};for(const a in n)if(Object.hasOwnProperty.call(n,a)){const o=n[a];r[a]=ae(o,e)}return e.set(n,r),r}}else return n}function ji(n,e=200){let t=null;return function(...s){t&&clearTimeout(t),t=setTimeout(()=>{n.apply(this,s)},e)}}function Oi(n){const e=n.getFullYear(),t=(n.getMonth()+1).toString().padStart(2,"0"),s=n.getDate().toString().padStart(2,"0"),i=n.getHours().toString().padStart(2,"0"),r=n.getMinutes().toString().padStart(2,"0"),a=n.getSeconds().toString().padStart(2,"0");return`${e}-${t}-${s} ${i}:${r}:${a}`}function os(n){const e=new Map;return e.set("",!0),function(t=10){let s="";const i=t,r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",a=r.length;for(;e.get(s)===!0;)for(let o=0;o<i;o++)s+=r.charAt(Math.floor(Math.random()*a));return e.set(s,!0),s}}function _e(n){return typeof n=="object"&&n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function pe(n,e){if(e<=0)throw new Error("输入的a和b必须大于0");return Math.random()<n/e}function ls(n){const e=new Date,t=e.getHours(),s=e.getMinutes(),i=t*60+s;for(const[r,a]of n){const o=r*60,c=a===24?1440:a*60;if(i>=o&&i<c)return!0}return!1}function ie(n=400,e=5){let t=0,s=null;return function(i){s&&clearTimeout(s),s=setTimeout(()=>{t=0},n),t++,t>=e&&i()}}class j{__elfland;constructor(e){this.__elfland=e,e.on("loaded",this.loadedCallback,this)}is(e,t){return e.name===t}includes(e,t){return e.matched.find(s=>s.name===t)!==void 0}}class W extends j{static KEY="THEME";theme=I("light");constructor(e){super(e);let t=X(W.KEY,"light");t=t==="light"?"light":"dark",Y("THEME",t),this.theme.value=t,t==="dark"&&(document.documentElement.classList.add("dark"),this.__elfland.emit("theme-change","dark")),J(this.theme,s=>{s=s==="light"?"light":"dark",this.__elfland.emit("theme-change",s),s==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),Y(W.KEY,s)})}toggle(){this.theme.value=this.theme.value==="light"?"dark":"light"}loadedCallback(){}}class Z{__promise;__ee;__state=0;get state(){return this.__state}get promise(){return this.__promise}constructor(){this.__ee=new K,this.__promise=new Promise((e,t)=>{this.__ee.on("resolve",()=>{e()}),this.__ee.on("reject",()=>{t()})}),this.__state=1}resolve(){this.__ee.emit("resolve"),this.__state=2}reject(){this.__ee.emit("reject"),this.__state=3}}class cs extends j{__dataIsGotten=!1;__dataPromise=new Z;__data=null;get waitingDataGet(){return this.__dataPromise.promise}get data(){return this.__data}constructor(e){super(e)}loadedCallback(){this.__elfland.routerPromise.addCheck(this.check,this)}async check(e,t){if(!this.__dataIsGotten)try{const i=await(await fetch("/data/RES.json")).json();this.__data=i,this.__dataPromise.resolve(),this.__dataIsGotten=!0}catch(s){console.error(s)}}}let hs=class Ee{category;child=null;constructor(e){this.category=e[0]||"未分组",e.shift(),e.length>0&&(this.child=new Ee(e))}},us=class{tag;constructor(e){this.tag=e}},ds=class{id;title;path;constructor(e,t,s){this.id=e,this.title=t,this.path=s}},ms=class{id;title;titlePinYin;path;time;author;body;categories;tags;links;created;modified;prev;next;constructor(e,t){e=ae(e),this.id=e.id,this.title=e.title,this.titlePinYin=e.titlePinYin,this.path=e.path,this.time=e.time,this.author=e.author,this.body=e.body,this.created=new Date(e.created),this.modified=new Date(e.modified),this.categories=new hs(e.categories),this.tags=Array.from(new Set(e.tags)).map(i=>new us(i)),this.links=e.links.map(i=>{const{id:r,path:a}=t.getIdAndPath(i);return new ds(r,i,a)});const s=t.getPrevAndNextById(e.id);this.prev=s.prev,this.next=s.next}};class fs extends j{__articlesIsGotten=!1;__articlesPromise=new Z;__id2article=G(new Map);__id2path=new Map;__path2id=new Map;__id2title=new Map;__title2id=new Map;__articles=D(()=>{const e=Array.from(this.__id2article.values());return e.sort((t,s)=>s.created.getTime()-t.created.getTime()),e});archivesSortMethodSelected=I("ByCreated");archivesSortMethodOptions=D(()=>["ByCreated","ByModified","ByTitlePinYin"]);__sortMethodIsAsc=G({ByCreated:!1,ByModified:!1,ByTitlePinYin:!0});archivesSortMethodIsAsc=D({get:()=>this.__sortMethodIsAsc[this.archivesSortMethodSelected.value],set:e=>{this.__sortMethodIsAsc[this.archivesSortMethodSelected.value]=e}});sortedArchives=D(()=>{const e=Array.from(this.__id2article.values());return e.sort((t,s)=>{switch(this.archivesSortMethodSelected.value){case"ByCreated":return this.archivesSortMethodIsAsc.value?t.created.getTime()-s.created.getTime():s.created.getTime()-t.created.getTime();case"ByModified":return this.archivesSortMethodIsAsc.value?t.modified.getTime()-s.modified.getTime():s.modified.getTime()-t.modified.getTime();case"ByTitlePinYin":return this.archivesSortMethodIsAsc.value?t.titlePinYin.localeCompare(s.titlePinYin):s.titlePinYin.localeCompare(t.titlePinYin)}}),e});get articles(){return this.__articles}get waitingDataGet(){return this.__articlesPromise.promise}constructor(e){super(e)}loadedCallback(){this.__elfland.routerPromise.addCheck(this.check,this)}async check(e,t){if(!this.__articlesIsGotten)try{await this.__elfland.data.waitingDataGet;const s=this.__elfland.data.data;if(s===null)return;s.docs.forEach(i=>{this.__id2path.set(i.id,i.path),this.__path2id.set(i.path,i.id),this.__id2title.set(i.id,i.title),this.__title2id.set(i.title,i.id)}),s.docs.forEach(i=>{this.__id2article.set(i.id,new ms(i,this))}),this.__articlesIsGotten=!0,this.__articlesPromise.resolve()}catch(s){console.error(s)}}getIdAndPath(e){const t=this.__title2id.get(e)||-1,s=this.__id2path.get(t)||"";return{id:t,path:s}}getPrevAndNextById(e){const t=Array.from(this.__id2path.keys()),s=t.indexOf(e);if(s===-1)return{prev:{path:"",title:""},next:{path:"",title:""}};const i=s-1<0?t.length-1:s-1,r=s+1>=t.length?0:s+1,a=t[i],o=t[r],c={path:this.__id2path.get(a),title:this.__id2title.get(a)},h={path:this.__id2path.get(o),title:this.__id2title.get(o)};return{prev:c,next:h}}getArticleByPath(e){const t=this.__path2id.get(e);if(t===void 0)return null;const s=this.__id2article.get(t);return s===void 0?null:s}}class _s{id;path;title;in=[];out=[];constructor(e,t,s){this.id=e,this.path=t,this.title=s}}ot([ct,ht,ut,dt,mt,ft]);class ps extends j{__linksIsGotten=!1;__linksData=new Map;__linksRenderData={nodes:[],links:[]};__chartElement=null;__myChart=null;__watchHandleTheme=null;__windowResizeFunc;constructor(e){super(e),this.__windowResizeFunc=this.resize.bind(this)}loadedCallback(){this.__elfland.routerPromise.addCheck(this.check,this)}async check(e,t){if(!this.__linksIsGotten)try{await this.__elfland.articles.waitingDataGet;const s=this.__elfland.articles.articles.value;s.forEach(i=>{const r=new _s(i.id,i.path,i.title);this.__linksData.set(i.id,r),this.__linksRenderData.nodes.push({id:i.id.toString(),name:i.title,path:i.path,category:"A"})}),s.forEach(i=>{const r=this.__linksData.get(i.id);i.links.forEach(a=>{const o=this.__linksData.get(a.id);if(o){o.in.push(r),r.out.push(o);const c=Math.min(r.id,o.id),h=Math.max(r.id,o.id);this.__linksRenderData.links.push({source:c.toString(),target:h.toString()})}})}),this.__linksRenderData.links=this.__linksRenderData.links.filter((i,r,a)=>a.findIndex(o=>o.source===i.source&&o.target===i.target)===r),this.__linksIsGotten=!0}catch(s){console.error(s)}}getLinks(e){return this.__linksData.get(e)}render(e){this.__chartElement=e,this.__watchHandleTheme&&this.__watchHandleTheme.stop(),this.distory();const t=this.renderChart();return this.__watchHandleTheme=J(this.__elfland.theme.theme,s=>{this.__myChart&&(this.__myChart.dispose(),this.__myChart=null),this.renderChart()}),t}distory(){window.removeEventListener("resize",this.__windowResizeFunc),this.__myChart&&(this.__myChart.dispose(),this.__myChart=null),this.__watchHandleTheme&&this.__watchHandleTheme.stop()}renderChart(){if(this.__chartElement===null)return;const e=this.__elfland.theme.theme.value,t=this.__linksRenderData,s={title:{text:"关系图谱",subtext:"点击结点以跳转文章",top:"20px",left:"20px"},tooltip:{show:!1},backgroundColor:"rgba(0, 0, 0, 0)",series:[{type:"graph",layout:"force",symbolSize:20,roam:!0,label:{show:!0,color:e==="dark"?"#fff":"#000",fontSize:12,position:"bottom"},force:{repulsion:5e3},edgeSymbol:["none","none"],edgeSymbolSize:[4,10],edgeLabel:{show:!1},data:t.nodes,links:t.links,categories:[{name:"A",itemStyle:{color:"#4fadff"}}],lineStyle:{opacity:.9,width:2},emphasis:{focus:"adjacency"},draggable:!0}]};return this.__myChart=lt(this.__chartElement,e==="light"?void 0:"dark"),this.__myChart.setOption(s),this.__myChart.on("click",i=>{if(i.dataType==="node"&&i.data){const r=i.data;this.__elfland.routerPromise.router.push({name:"article",params:{articlePath:r.path}})}}),window.addEventListener("resize",this.__windowResizeFunc),!0}resize(){this.__myChart&&this.__myChart.resize()}}function gs(n){["warning","tip","info","success"].forEach(t=>{n.use(re,t,{render:function(s,i){return s[i].nesting===1?'<div class="md-c-c md-c-c--'+t+'"><p>'+t.toLocaleUpperCase()+`</p>
`:`</div>
`}})})}function ys(n){gs(n),n.use(re,"details",{validate:function(e){return e.trim().match(/^details\s+(.*)$/)},render:function(e,t){const s=e[t].info.trim().match(/^details\s+(.*)$/);return e[t].nesting===1&&s?"<details><summary>"+n.utils.escapeHtml(s[1])+`</summary>
`:`</details>
`}}),n.use(re,"image",{validate:function(e){return e.trim().match(/^image\s+(.*)$/)},render:function(e,t){const s=e[t].info.trim().match(/^image\s+(.*)$/);return e[t].nesting===1?`<div class="md-c-img">
`:s===null?"</div>":"<span>"+(s[1]==="null"?"":n.utils.escapeHtml(s[1]))+`</span></div>
`}})}const vs=[ys];function ks(n){n.use(Pe)}function bs(n){n.use(ue,{permalink:ue.permalink.linkInsideHeader({placement:"before"})})}function ws(n,e){n.use(Ae,{listType:"ul",level:[1],callback:(t,s)=>{e.renderToc(t,s)}})}function Ds(n){n.use(_t,{throwOnError:!1,errorColor:"#cc0000"})}const Ss=[ks,bs,ws,Ds];function Ms(n){n.use(Ie)}function Ts(n){n.use(Fe)}function Es(n){n.use(Ne)}function Cs(n){n.use(Be)}function xs(n){n.use(je)}const Ls=[Ms,Ts,Es,Cs,xs];function Ps(n,e,t){const s=t&&t.baseUrl||"",i=n.renderer.rules.image;function r(a,o,c,h,d){const y=a[o].attrGet("src")||"";return y.startsWith("http://")||y.startsWith("https://")||y.startsWith("data:image")||y.startsWith("file://")||y.startsWith("blob:")||a[o].attrSet("src",s+"/data/assets/"+y),i===void 0?"":i(a,o,c,h,d)}n.renderer.rules.image=r}const As=[Ps];function ge(n,e,t){function s(p,T,A,M,_){return p[T].nesting===1&&p[T].attrJoin("class",e),_.renderToken(p,T,A,M,_)}t=t||{};const i="{(",r=")}",a=t.begin||"begin",o=t.end||"end",c=t.indent||!1;t.indentSize;const h=t.className||"",d=t.render||s;function y(p,T,A,M){let _;if(i!==p.src.slice(T,T+2))return!1;let m=!1;for(_=T+2;_<A;_++)if(p.src.slice(_,_+2)===r){m=!0;break}if(!m)return!1;const v=p.src.slice(T+2,_),f=v.split("|").map(g=>g.trim()),S=i+v+r;let l=!1,u;if(f[0]===a)u=1,f[1]===e&&(l=!0);else if(f[0]===o)u=-1;else return!1;return{markerType:u,data:f,markup:S,line:M,self:l}}function b(p,T,A,M){let _=0,m=T,v=null,f=null;for(;m<A;m++){const S=p.bMarks[m]+p.tShift[m],l=p.eMarks[m],u=y(p,S,l,m);if(u)if(u.markerType===1)if(v===null&&u.self){if(v=u,M)return!0}else{if(v===null)return!1;_++}else if(_===0&&v!==null){f=u;break}else _--;else{if(v===null)return!1;continue}}return v&&f?{markerBegin:v,markerEnd:f}:!1}function N(p,T,A){}function P(p,T,A,M){const _=b(p,T,A,M);if(!_)return!1;if(_===!0)return!0;c&&(_.markerBegin.line,_.markerEnd.line,void 0);const m=p.parentType,v=p.lineMax;p.parentType="layout",p.lineMax=_.markerEnd.line;const f=p.push("layout_"+e+"_open","div",1);f.markup=_.markerBegin.markup,f.block=!0,f.meta={data:_.markerBegin.data,className:h},f.map=[_.markerBegin.line,_.markerEnd.line],p.md.block.tokenize(p,T+1,_.markerEnd.line);const S=p.push("layout_"+e+"_close","div",-1);return S.markup=_.markerEnd.markup,S.block=!0,S.meta={data:_.markerEnd.data},p.parentType=m,p.lineMax=v,p.line=_.markerEnd.line+1,!0}n.block.ruler.before("fence","layout_"+e,P,{alt:["paragraph","reference","blockquote","list"]}),n.renderer.rules["layout_"+e+"_open"]=d,n.renderer.rules["layout_"+e+"_close"]=d}function Is(n){n.use(ge,"container",{className:"md-layout-c",render:function(e,t){const s=[["w","width"],["h","height"],["style","style"],["class","class"]];if(e[t].nesting===1){let i="",r=e[t].meta.className+" ";return e[t].meta.data.forEach(a=>{const o=a.split("=")[0],c=a.indexOf("="),h=a.slice(c+1,a.length),d=s.find(y=>y[0]===o);d&&(d[1]==="style"?i+=h:d[1]==="class"?r+=h:i+=d[1]+":"+h+";")}),'<div class="'+(r===" "?"":r)+'" style="'+i+`">
`}else return`</div>
`}}),n.use(ge,"item",{className:"md-layout-i",render:function(e,t){const s=[["w","width"],["h","height"],["style","style"],["class","class"]];if(e[t].nesting===1){let i="",r=e[t].meta.className+" ";return e[t].meta.data.forEach(a=>{const o=a.split("=")[0],c=a.indexOf("="),h=a.slice(c+1,a.length),d=s.find(y=>y[0]===o);d&&(d[1]==="style"?i+=h:d[1]==="class"?r+=h:i+=d[1]+":"+h+";")}),'<div class="'+(r===" "?"":r)+'" style="'+i+`">
`}else return`</div>
`}})}const Fs=[Is];function Ns(n,e,t){if(typeof e!="string"||e==="")return;const s=Array.isArray(e)?e[0]:e,i=new Set(Array.isArray(e)?e:[e]);function r(l,u,g,E,k){return l[u].nesting===1&&l[u].attrJoin("class",s),k.renderToken(l,u,g)}function a(l,u,g,E,k){return k.renderToken(l,u,g)}t=t||{};const o=t.markerBegin||"{|",c=t.markerEnd||"|}",h=t.dataDivision||"|-",d=t.configDivision||"|";t.useEqual;const y=t.useIndex||!1,b=t.configKeys||[],N=T(b),P=t.render||r,p=t.renderDivision||a;t.init instanceof Function&&t.init(t);function T(l){const u=new Map;return l.forEach(g=>{if(Array.isArray(g)){const E=g[0];g.forEach(k=>{u.set(E,k)})}else u.set(g,g)}),u}function A(l,u){const g=o.length;if(o!==l.src.slice(u,u+g))return{check:!1};const E=l.src.indexOf(d,u+g),k=l.src.slice(u+g,E).trim();return i.has(k)?{check:!0,name:!0,pos:u+g+e.length}:{check:!0,name:!1}}function M(l,u){return c!==l.src.slice(u,u+c.length)?{check:!1}:{check:!0,pos:u}}function _(l,u){return h!==l.src.slice(u,u+h.length)?{check:!1}:{check:!0,pos:u}}function m(l,u,g,E){let k=0,w=u,C=null,F=null,x=-1;const L=[];let O=null;for(;w<g;w++){const $=l.bMarks[w]+l.tShift[w];l.eMarks[w];const R=A(l,$);if(R.check)if(R.name){if(C)k++;else if(C={markup:o,pos:R.pos,line:w},E)return{check:!0,silent:!0}}else k++;else{if(C===null)return{check:!1};if(M(l,$).check){if(k===0)return F={markup:c,line:w},x!==-1&&L.push({lineBegin:x+1,lineEnd:w}),{configList:O||[],dataList:L,check:!0,markerBeginData:C,markerEndData:F};k--}else{const he=_(l,$);if(he.check&&k===0)O===null?(O=l.src.slice(C.pos,he.pos).split(d).map(se=>se.trim()).filter(se=>se!==""),x=w):(w-x<=1||L.push({lineBegin:x+1,lineEnd:w}),x=w);else continue}}}return{check:!1}}function v(l,u,g){const E=new RegExp("(?<!\\\\)=","g"),k=new RegExp("(?<!\\\\),","g"),w=E.exec(l);E.lastIndex=0;const C=w===null?-1:w.index,F=C===-1?g.toString():l.slice(0,C).trim(),x=C===-1?l:l.slice(C+1).trim(),L=[];let O=k.exec(x),$=0;for(;O!==null;)L.push(x.slice($,O.index).trim()),$=O.index+1,O=k.exec(x);if(L.push(x.slice($).trim()),k.lastIndex=0,C!==-1&&Number.isNaN(Number(F))){const R=N.get(F);if(R===void 0)return;u[R]=L;return}if(y&&!Number.isNaN(Number(F))){const R=Number(F);b[R]!==void 0?Array.isArray(b[R])?u[b[R][0]]=L:u[b[R]]=L:u[F]=L;return}}function f(l){const u={};return l.forEach((g,E)=>{v(g,u,E)}),u}function S(l,u,g,E){const k=m(l,u,g,E);if(!k.check)return!1;if(k.silent!==void 0)return!0;const w=l.parentType,C=l.lineMax;l.parentType="blockquote",l.lineMax=k.markerEndData.line;const F=l.push("component_"+e+"_open","div",1);F.markup=o,F.block=!0,F.meta={configs:f(k.configList)},F.map=[k.markerBeginData.line,k.markerEndData.line],k.dataList.forEach((L,O)=>{const $=l.bMarks[L.lineBegin]+l.tShift[L.lineBegin],R=l.bMarks[L.lineEnd]+l.tShift[L.lineEnd];if(l.src.slice($,R),O>0){const te=l.push("component_"+e+"_division","div",0);te.markup=h,te.meta={index:O}}l.md.block.tokenize(l,L.lineBegin,L.lineEnd)});const x=l.push("component_"+e+"_close","div",-1);return x.markup=c,x.block=!0,l.parentType=w,l.lineMax=C,l.line=k.markerEndData.line+1,!0}n.block.ruler.before("fence","component_"+e,S,{alt:["paragraph","reference","blockquote","list"]}),n.renderer.rules["component_"+e+"_open"]=P,n.renderer.rules["component_"+e+"_close"]=P,n.renderer.rules["component_"+e+"_division"]=p}function Bs(n){n.use(Ns,"classify",{render:function(e,t){const s=e[t];if(s.nesting===1){const i=Math.floor(Math.random()*1e6).toString(),a=s.meta.configs.classifies||[];let o="";return a.forEach((c,h)=>{const d='<div><label><input type="radio" name="'+i+'" value="'+h.toString()+'" hidden '+(h===0?"checked":"")+"> "+c+"</label></div>";o+=d}),`<div class="markdown-it-component-classify-container">
<div class="markdown-it-component-classify">
<div head>
`+o+`
</div>
<div body>
<div>
`}else return`</div>
</div>
</div>
</div>
`},renderDivision:function(e,t){return`</div>
<div>
`},init:function(e){const s="markdown-it-classify-style";let i=`
.markdown-it-component-classify-container {
  border-radius: 8px;
  border: 1px solid var(--bl-color-base-border);
  overflow: hidden;
  margin-bottom: 1rem;
}
.markdown-it-component-classify > div > div {
  position: relative;
}
.markdown-it-component-classify > div[body] > div {
  display: none;
  padding: 0.5rem;
}
.markdown-it-component-classify > div[head] {
  display: flex;
  flex-wrap: wrap;
  background-color: var(--bl-color-light-fill);
}
.markdown-it-component-classify > div[head] > div > label {
  padding: 0.5rem 1rem;
  cursor: pointer;
  transition: color 0.2s;
  box-sizing: border-box;
  display: block;
  font-weight: bold;
  color: var(--bl-color-secondary-text);
}
.markdown-it-component-classify > div[head] > div:nth-child(n + 2)::before {
  content: '';
  position: absolute;
  top: 50%;
  transform: translateY(-50%) translateX(-50%);
  width: 1px;
  height: 40%;
  background-color: var(--bl-color-primary-text);
}
.markdown-it-component-classify > div[head] > div > label:has(input:checked) {
  transition: color 0.2s;
  color: var(--bl-color-primary-text);
}
.markdown-it-component-classify > div[head] > div > label:hover {
  transition: color 0.2s;
  color: var(--bl-color-primary-text);
}
.markdown-it-component-classify > div[body] > div > *:last-child {
  margin-bottom: 0 !important;
}

      `;for(let r=1;r<=10;r++)r>1&&(i+=`,
`),i+=`.markdown-it-component-classify:has( > div[head] > div:nth-child(${r}) > label > input:checked) > div[body] > div:nth-child(${r})`;if(i+=` {
  display: block;
}
      `,!document.getElementById(s)){const r=document.createElement("style");r.setAttribute("id",s),r.setAttribute("type","text/css"),r.innerHTML=i.trim(),(document.head||document.getElementsByTagName("head")[0]).appendChild(r)}},configKeys:["classifies"]})}const js=[Bs];function V(n,e,t){function s(m,v,f,S,l){return l.renderToken(m,v,f)}function i(m,v,f,S,l){return l.renderToken(m,v,f)}t=t||{};const r=Array.isArray(e)?e[0]:e,a=new Set(Array.isArray(e)?e:[e]),o=t.tokenizePos||[1],c=t.markerBegin||"{{",h=t.markerEnd||"}}",d=t.markerDivision||"|";t.useEqual;const y=t.useIndex||!1,b=t.configKeys||[],N=T(b),P=t.render||s,p=t.renderDivision||i;function T(m){const v=new Map;return m.forEach(f=>{if(Array.isArray(f)){const S=f[0];f.forEach(l=>{v.set(S,l)})}else v.set(f,f)}),v}function A(m){const v=m.posMax;let f=m.pos+c.length,S=0,l=f;const u=[];for(;f<v;){if(c===m.src.slice(f,f+c.length))S++;else if(h===m.src.slice(f,f+h.length)){if(S===0)return u.push({begin:l,end:f}),{check:!0,pos:f,divisionDataList:u};S--}else d===m.src.slice(f,f+d.length)&&S===0&&(u.push({begin:l,end:f}),l=f+1);f++}return{check:!1}}function M(m,v,f){const S=new RegExp("(?<!\\\\)=","g"),l=new RegExp("(?<!\\\\),","g"),u=S.exec(m);S.lastIndex=0;const g=u===null?-1:u.index,E=g===-1?f.toString():m.slice(0,g).trim(),k=g===-1?m:m.slice(g+1).trim(),w=[];let C=l.exec(k),F=0;for(;C!==null;)w.push(k.slice(F,C.index).trim()),F=C.index+1,C=l.exec(k);if(w.push(k.slice(F).trim()),l.lastIndex=0,g!==-1&&Number.isNaN(Number(E))){const x=N.get(E);if(x===void 0)return;v[x]=w;return}if(y&&!Number.isNaN(Number(E))){const x=Number(E);b[x]!==void 0?Array.isArray(b[x])?v[b[x][0]]=w:v[b[x]]=w:v[E]=w;return}}function _(m,v){const f=m.posMax,S=m.pos;if(c!==m.src.slice(S,S+c.length))return!1;const l=A(m);if(!l.check)return!1;const u=l.pos,g=l.divisionDataList;if(g.length<1||!a.has(m.src.slice(g[0].begin,g[0].end).trim()))return!1;const E=S+c.length,k=u,w={};let C=0;if(!v){m.pos=E,m.posMax=k;const F=m.push("template_"+r+"_open","span",1);let x=0;g.forEach((L,O)=>{O!==0&&(m.pos=L.begin,m.posMax=L.end,o===!0||Array.isArray(o)&&o.indexOf(O)!==-1?(C>0&&m.push("template_"+r+"_division","",0),m.md.inline.tokenize(m),C++):M(m.src.slice(L.begin,L.end),w,x++))}),F.meta={configs:w},m.push("template_"+r+"_close","span",-1)}return m.pos=u+h.length,m.posMax=f,!0}n.inline.ruler.after("emphasis","template_"+r,_),n.renderer.rules["template_"+r+"_open"]=P,n.renderer.rules["template_"+r+"_close"]=P,n.renderer.rules["template_"+r+"_division"]=p}function Os(n){n.use(V,"und",{useIndex:!0,configKeys:["type"],render:function(e,t){const s=e[t],i={default:"transparent",warning:"#f89898D0",success:"#95d475D0",r:"var(--bl-color-md-plugin-underline-r)",g:"var(--bl-color-md-plugin-underline-g)",b:"var(--bl-color-md-plugin-underline-b)",y:"var(--bl-color-md-plugin-underline-y)"};if(s.nesting===1){const r=s.meta.configs,a=r.type&&r.type[0]||"default";return`<span style="${`background: linear-gradient(transparent 70%, ${i[a.trim()]||a.trim()} 0%);`}">`}else return"</span>"}})}function Rs(n){n.use(V,"bgc",{useIndex:!0,configKeys:["type"],render:function(e,t){const s=e[t],i={default:"transparent",warning:"#f89898D0",success:"#95d475D0",r:"var(--bl-color-md-plugin-underline-r)",g:"var(--bl-color-md-plugin-underline-g)",b:"var(--bl-color-md-plugin-underline-b)",y:"var(--bl-color-md-plugin-underline-y)"};if(s.nesting===1){const r=s.meta.configs,a=r.type&&r.type[0]||"default";return`<span style="${`background-color: ${i[a.trim()]||a.trim()};`}">`}else return"</span>"}})}function qs(n){n.use(V,"tran",{useIndex:!0,configKeys:["from","to"],render:function(e,t){const s=e[t];if(s.nesting===1){const i=Math.floor(Math.random()*1e6).toString(),r=s.meta.configs,a=r.from&&r.from[0]||"原文:",o=r.to&&r.to[0]||"译文:";return'<span class="md-template-translate">'+`<label data-from="${a}" data-to="${o}" class="md-template-translate__label"><input type="checkbox" name="${i}" hidden ></label>`+"<span>"}else return"</span></span>"},renderDivision:function(e,t){return"</span><span>"},tokenizePos:[1,2]})}function $s(n,e){n.use(V,"link",{useIndex:!0,configKeys:["name"],render:function(t,s){const i=t[s];if(i.nesting===1){const r=i.meta.configs,a=r.name&&r.name[0]||"Error",o=e.article.getPathByTitle(a),c=o===""?"":"cursor-pointer text-moonlight-500 hover:underline",h=o===""?"":window.location.protocol+"//"+window.location.host+"/blog/"+o;return`<span class="${c}" md="obsidian-link" path="${o}" title=${h}>`+a}else return"</span>"},renderDivision:function(t,s){return"</span><span>"},tokenizePos:[]})}const Vs=[Os,Rs,qs,$s];function zs(n,e){n.use(V,"template-name-1",{configKeys:["type"],render:function(t,s){const i=t[s],r={default:"transparent",warning:"#F56C6C",success:"#67C23A"};if(i.nesting===1){const a=i.meta.configs;console.log("template-name-1 configs",a);const o=a.type&&a.type[0]||"default";return`<span style="${`background-color: ${r[o.trim()]||o.trim()};`}">`}else return"</span>"}})}function Hs(n,e){n.use(V,"template-name-2",{configKeys:["chars","color"],render:function(t,s){const i=t[s];if(i.nesting===1){const r=i.meta.configs;console.log("template-name-2 configs",r);const a=r.chars||[],o=r.color||"",c=a.join("-");return`<span style="color: ${o}">${c}`}else return"</span>"}})}function Gs(n,e){n.use(V,"template-name-3",{configKeys:["chars","color"],useIndex:!0,render:function(t,s){const i=t[s];if(i.nesting===1){const r=i.meta.configs;console.log("template-name-3 configs",r);const a=r.chars||[],o=r.color||"",c=a.join("-");return`<span style="color: ${o}">${c}`}else return"</span>"}})}function Us(n,e){n.use(V,"template-name-4",{configKeys:["chars","color"],tokenizePos:[],useIndex:!0,render:function(t,s){const i=t[s];if(i.nesting===1){const r=i.meta.configs;console.log("template-name-4 configs",r);const a=r.chars||[],o=r.color||"",c=a.join("-");return`<span style="color: ${o}">${c}`}else return"</span>"}})}const Qs=[zs,Hs,Gs,Us],Ys=[...vs,...Ss,...Ls,...As,...Fs,...js,...Vs,...Qs];function Ks(n,e,t){Ys.forEach(s=>{s(n,e,t)})}B.registerLanguage("javascript",Oe);B.registerLanguage("typescript",pt);B.registerLanguage("css",Re);B.registerLanguage("xml",we);B.registerLanguage("c",qe);B.registerLanguage("cmake",$e);B.registerLanguage("cpp",Ve);B.registerLanguage("markdown",ze);B.registerLanguage("json",He);B.registerLanguage("latex",Ge);B.registerLanguage("python",Ue);B.registerLanguage("yaml",Qe);B.registerLanguage("html",we);B.registerLanguage("vue",n=>({subLanguage:"xml",contains:[n.COMMENT("<!--","-->",{relevance:10}),{begin:/^(\s*)(<script setup>)/gm,end:/^(\s*)(<\/script>)/gm,subLanguage:"javascript",excludeBegin:!0,excludeEnd:!0},{begin:/^(\s*)(<script setup lang=["']ts["']>)/gm,end:/^(\s*)(<\/script>)/gm,subLanguage:"typescript",excludeBegin:!0,excludeEnd:!0},{begin:/^(\s*)(<style(\sscoped)?>)/gm,end:/^(\s*)(<\/style>)/gm,subLanguage:"css",excludeBegin:!0,excludeEnd:!0},{begin:/^(\s*)(<style lang=["'](scss|sass)["'](\sscoped)?>)/gm,end:/^(\s*)(<\/style>)/gm,subLanguage:"scss",excludeBegin:!0,excludeEnd:!0},{begin:/^(\s*)(<style lang=["']stylus["'](\sscoped)?>)/gm,end:/^(\s*)(<\/style>)/gm,subLanguage:"stylus",excludeBegin:!0,excludeEnd:!0}]}));class U{static CODE_SCROLL_KEY="md-code-scroll";md;article;generateRandomString=os();codeScroll=X(U.CODE_SCROLL_KEY,!1)==="true";svg='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" ><path fill="currentColor" d="M128 320v576h576V320zm-32-64h640a32 32 0 0 1 32 32v640a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V288a32 32 0 0 1 32-32M960 96v704a32 32 0 0 1-32 32h-96v-64h64V128H384v64h-64V96a32 32 0 0 1 32-32h576a32 32 0 0 1 32 32M256 672h320v64H256zm0-192h320v64H256z"></path></svg>';svgCodeScroll='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" ><path fill="currentColor" d="M511.552 128c-35.584 0-64.384 28.8-64.384 64.448v516.48L274.048 570.88a94.272 94.272 0 0 0-112.896-3.456 44.416 44.416 0 0 0-8.96 62.208L332.8 870.4A64 64 0 0 0 384 896h512V575.232a64 64 0 0 0-45.632-61.312l-205.952-61.76A96 96 0 0 1 576 360.192V192.448C576 156.8 547.2 128 511.552 128M359.04 556.8l24.128 19.2V192.448a128.448 128.448 0 1 1 256.832 0v167.744a32 32 0 0 0 22.784 30.656l206.016 61.76A128 128 0 0 1 960 575.232V896a64 64 0 0 1-64 64H384a128 128 0 0 1-102.4-51.2L101.056 668.032A108.416 108.416 0 0 1 128 512.512a158.272 158.272 0 0 1 185.984 8.32z"></path></svg>';svgPlayground='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" ><path fill="currentColor" d="M32 128h960v64H32z"></path><path fill="currentColor" d="M192 192v512h640V192zm-64-64h768v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32z"></path><path fill="currentColor" d="M322.176 960H248.32l144.64-250.56 55.424 32zm453.888 0h-73.856L576 741.44l55.424-32z"></path></svg>';constructor(e){this.article=e,this.md=new Ye({breaks:!0,linkify:!0,highlight:(t,s)=>{s=s.trim();const i=s.indexOf(":"),a=(i===-1?"":s.slice(i+1)).split(",").map(l=>l.trim()).filter(l=>l!==""),o=a[0]===void 0||a[0]==="null"?"":a[0],c=a[1],h=a[2]||"";s=i===-1?s:s.slice(0,i);const d=this.generateRandomString(),y=`<span class="md-code-btn md-copy-btn select-none" title="点击复制" type="button" data-clipboard-action="copy" data-clipboard-target="#copy${d}">${this.svg}</span>`,b=`<span class="md-code-btn select-none" md="codeScroll" title="调整代码块最大高度" ${this.codeScroll?"checked":""}>${this.svgCodeScroll}</span>`,N=`<span class="md-code-btn select-none" md="playground" title="在 Playground 中编辑" data-example-code="${c}" data-example-id="${h}" >${this.svgPlayground}</span>`,P="<span>"+this.getLang(s)+"</span>",p=`<span>${o}</span>`,T=this.md.utils.escapeHtml(t);let A=T;if(s&&B.getLanguage(s))try{A=B.highlight(t,{language:s,ignoreIllegals:!0}).value}catch{}const M=`<div>${P}${p}</div>`,_=`<div>${h===""?"":N}${b}${y}</div>`,m=`<pre class="hljs">${A}<code></code></pre>`,v=`<div>${M}${_}</div>`,f=`<textarea style="position: absolute;top: -9999px;left: -9999px;z-index: -9999;" id="copy${d}">${T}</textarea>`;return`<div class="hljs-container">${v}${m}${f}</div>`}}),this.init()}render(e){function t(){const s=location.hash.slice(1);s&&requestAnimationFrame(()=>{const i=document.getElementById(s)||document.querySelector(`[id="${s}"]`);i&&i.scrollIntoView({behavior:"smooth"})})}return t(),this.md.render(e)}getLang(e){return e=e||"",e===""?e:{}[e]||e}init(){Ks(this.md,this,{baseUrl:window.location.protocol+"//"+window.location.host})}renderToc(e,t){this.article.mdTocString=JSON.stringify(t)}}class Ws extends j{__path=I("");__articleLRUCache=new ss(20);__mdRenderer=new U(this);__mdTocString=I("");__clipboard;get article(){return D(()=>this.__articleLRUCache.get(this.__path.value)||null)}get renderedMd(){return D(()=>{const e=this.article.value;return e===null?"":this.__mdRenderer.render(e.body)})}get mdTocString(){return this.__mdTocString.value}set mdTocString(e){this.__mdTocString.value=e}get rendererMdToc(){return D(()=>{const e=new Map,t=this.__mdTocString.value,s=JSON.parse(t),i=[],r=a=>{let o=encodeURIComponent(a.n.trim().replace(/\ /g,"-").toLowerCase());e.has(a.n)?(o+=`-${e.get(a.n)}`,e.set(a.n,e.get(a.n)+1)):e.set(a.n,1);const c={l:a.l,n:a.n.trim(),a:"#"+o};i.push(c),a.c.forEach(h=>r(h))};return r(s),i.shift(),i})}constructor(e){super(e),this.__clipboard=new Ke(".md-copy-btn"),this.__clipboard.on("success",t=>{fe("复制成功","success")}),this.__clipboard.on("error",t=>{fe("复制失败")})}loadedCallback(){this.__elfland.routerPromise.addCheck(this.check,this),this.__elfland.routerPromise.addPostcheck(this.postcheck,this),this.__elfland.selector.addSelectorList([["click",'.markdown-body span[md="codeScroll"]',"clickCodeScroll",{childrenEvent:!0}],["touchstart",'.markdown-body span[md="codeScroll"]',"clickCodeScroll",{childrenEvent:!0}],["click",'.markdown-body span[md="obsidian-link"]',"clickObsidianLink",{childrenEvent:!0}],["touchstart",'.markdown-body span[md="obsidian-link"]',"clickObsidianLink",{childrenEvent:!0}],["click",'.markdown-body span[md="playground"]',"clickPlayground",{childrenEvent:!0}],["touchstart",'.markdown-body span[md="playground"]',"clickPlayground",{childrenEvent:!0}]]),this.__elfland.selector.on("clickCodeScroll",e=>{const t=X(U.CODE_SCROLL_KEY,!1)==="true";Y(U.CODE_SCROLL_KEY,!t);const s=document.querySelectorAll('.markdown-body span[md="codeScroll"]');for(let i=0;i<s.length;i++)t?s[i].removeAttribute("checked"):s[i].setAttribute("checked","")}),this.__elfland.selector.on("clickObsidianLink",e=>{const s=e.element.getAttribute("path");s!==""&&typeof s=="string"&&(window.scrollTo(0,0),this.__elfland.routerPromise.router.push(s))}),this.__elfland.selector.on("clickPlayground",e=>{const t=e.element,s=t.getAttribute("data-example-code"),i=t.getAttribute("data-example-id");switch(s){case"html":this.__elfland.routerPromise.router.push({name:"playground",query:{example:i}});break;case"ts":this.__elfland.routerPromise.router.push({name:"ts-playground",query:{example:i}});break}})}getPathByTitle(e){return this.__elfland.articles.getIdAndPath(e).path}async check(e,t){if(!this.is(e,"article"))return;const s=e.params.articlePath;if(typeof s!="string")return{name:"404"};await this.__elfland.articles.waitingDataGet;const i=this.__elfland.articles.getArticleByPath(s);if(i===null)return{name:"404"};this.__articleLRUCache.set(s,i)}postcheck(e,t){if(!this.is(e,"article"))return;const s=e.params.articlePath;typeof s=="string"&&(this.__path.value=s)}}class Js{name;category;author;contributors;role;description;notes;url;github;video;arxiv;docs;blog;blogDocs;constructor(e){this.name=e.name,this.category=e.category,this.author=e.author,this.contributors=e.contributors,this.role=e.role,this.description=e.description,this.notes=e.notes,this.url=e.url,this.github=e.github,this.video=e.video,this.arxiv=e.arxiv,this.docs=e.docs,this.blog=e.blog,this.blogDocs=e["blog-docs"]}}class ye{category;projects=[];constructor(e){this.category=e}addProject(e){this.projects.push(e)}}class Xs extends j{__projectsIsGotten=!1;__projects=G(new Map);__pinnedProjects=G(new Map);pinnedProjects=D(()=>this.__pinnedProjects.get(this.__elfland.i18n.getLang().value)||[]);projectsCategorySorted=D(()=>this.__projects.get(this.__elfland.i18n.getLang().value)||[]);constructor(e){super(e)}loadedCallback(){this.__elfland.routerPromise.addCheck(this.check,this)}async check(e,t){if(!this.__projectsIsGotten)try{await this.__elfland.data.waitingDataGet;const s=this.__elfland.data.data;if(s===null)return;s.projects,this.__elfland.i18n.langList.forEach(i=>{s.projects[i]!==void 0&&this.createProjectsDatabase(i,s.projects[i])}),this.__projectsIsGotten=!0}catch(s){console.error(s)}}createProjectsDatabase(e,t){const s=t.slice(2),i=t[0].Sorted,r=[],a=[];i.forEach(o=>{r.push(new ye(o))}),s.forEach(o=>{const c=new Js(o);o.pinned&&a.push(c);const h=r.find(d=>d.category===o.category);if(h)h.addProject(c);else{const d=new ye(o.category);d.addProject(c),r.push(d)}}),this.__projects.set(e,r),this.__pinnedProjects.set(e,a)}}class Zs{tag;articles=[];get size(){return this.articles.length}constructor(e){this.tag=e}addArticle(e){this.articles.push(e)}}class ei extends j{__tagsIsGotten=!1;__tags=G(new Map);__selectedTag=I("");sortIsAsc=I(!1);sortedArticels=D(()=>{const e=this.__selectedTag.value;if(e==="")return[];const t=this.__tags.get(e);return t?t.articles.sort((s,i)=>this.sortIsAsc.value?s.created.getTime()-i.created.getTime():i.created.getTime()-s.created.getTime()):[]});tags=D(()=>Array.from(this.__tags.values()));constructor(e){super(e)}loadedCallback(){this.__elfland.routerPromise.addCheck(this.check,this),this.__elfland.routerPromise.addPostcheck(this.postcheck,this)}async check(e,t){if(!this.__tagsIsGotten)try{await this.__elfland.articles.waitingDataGet,this.__elfland.articles.articles.value.forEach(i=>{i.tags.forEach(r=>{this.__tags.has(r.tag)||this.__tags.set(r.tag,new Zs(r.tag)),this.__tags.get(r.tag).addArticle(i)})}),this.__tagsIsGotten=!0}catch(s){console.error(s)}}postcheck(e,t){if(!this.is(e,"tags"))return;const s=e.query.tag;this.__selectedTag.value=s?typeof s=="string"?s:s[0]:""}}class ce{category;children=new Map;allArts=[];selfArts=[];parent=null;fold=!0;get categories(){return Array.from(this.children.values())}get path(){return this.category==="ROOT"||this.parent===null?"":this.parent.path+"/"+this.category}constructor(e,t){this.category=e||"ROOT",this.parent=t||null}addArticle(e,t){this.allArts.push(e);const s=t.category;this.children.has(s)||this.children.set(s,new ce(s,this));const i=this.children.get(s);t.child===null?(i.allArts.push(e),i.selfArts.push(e)):i.addArticle(e,t.child)}}class ti extends j{__categoriesIsGotten=!1;__category=G(new ce);__selcetedCategory=I("");__displayArticlesList=D(()=>{if(this.__selcetedCategory.value==="")return[];const e=this.__selcetedCategory.value.split("/").filter(i=>i!=="");let t=[],s=this.__category;for(;e.length>0;){if(s=s.children.get(e.shift()||""),!s)return[];t=s.allArts}return t});get categories(){return this.__category.categories.sort((e,t)=>e.category==="未分组"?1:-1)}sortIsAsc=I(!1);sortedArticels=D(()=>this.__displayArticlesList.value.sort((e,t)=>this.sortIsAsc.value?e.created.getTime()-t.created.getTime():t.created.getTime()-e.created.getTime()));constructor(e){super(e)}loadedCallback(){this.__elfland.routerPromise.addCheck(this.check,this),this.__elfland.routerPromise.addPostcheck(this.postcheck,this)}async check(e,t){if(!this.__categoriesIsGotten)try{await this.__elfland.articles.waitingDataGet,this.__elfland.articles.articles.value.forEach(i=>{this.__category.addArticle(i,i.categories)}),this.__categoriesIsGotten=!0}catch(s){console.error(s)}}postcheck(e,t){if(!this.is(e,"categories"))return;const s=e.query.category;if(this.__selcetedCategory.value=s?typeof s=="string"?s:s[0]:"",this.__selcetedCategory.value==="")return;const i=this.__selcetedCategory.value.split("/").filter(a=>a!=="");let r=this.__category;for(;i.length>0;){if(r=r.children.get(i.shift()||""),!r)return;r.fold=!1}}}class si{name;position;avater;about;github;links=[];skills=[];constructor(e){this.name=e.name,this.position=e.position,this.avater=e.avater,this.about=e.about,this.github=e.github,e.links.forEach(t=>{this.links.push(t)}),e.skills.forEach(t=>{this.skills.push(t)})}}class ii extends j{__aboutIsGotten=!1;__abouts=G(new Map);__lang=D(()=>this.__elfland.i18n.getLang().value);name=D(()=>this.__abouts.get(this.__lang.value)?.name||"");position=D(()=>this.__abouts.get(this.__lang.value)?.position||"");avater=D(()=>this.__abouts.get(this.__lang.value)?.avater||"");about=D(()=>this.__abouts.get(this.__lang.value)?.about||[]);github=D(()=>this.__abouts.get(this.__lang.value)?.github||"");links=D(()=>this.__abouts.get(this.__lang.value)?.links||[]);skills=D(()=>this.__abouts.get(this.__lang.value)?.skills||[]);constructor(e){super(e)}loadedCallback(){this.__elfland.routerPromise.addCheck(this.check,this)}async check(e,t){if(!this.__aboutIsGotten)try{await this.__elfland.data.waitingDataGet;const s=this.__elfland.data.data;if(s===null)return;const i=s.about;this.__elfland.i18n.langList.forEach(r=>{i[r]!==void 0&&this.createAboutItem(r,i[r])}),this.__aboutIsGotten=!0}catch(s){console.error(s)}}createAboutItem(e,t){this.__abouts.set(e,new si(t))}}class ri extends j{__tsFilesListIsGotten=!1;__tsFilesListPromise=new Z;__tsFilesList=[];__tsFiles=new Map;__selectedExample=I("def");get selectedExampleFiles(){return D(()=>this.__tsFiles.get(this.__selectedExample.value)||{"/index.ts":"console.log('Hello World')"})}constructor(e){super(e),this.__tsFiles.set("def",{"/index.ts":`import { add } from './math.ts'
import _ from 'lodash'
console.log('sum =', add(1,2))
console.log('lodash version', _.VERSION)`,"/math.ts":"export const add = (a:number, b:number)=> a + b"})}loadedCallback(){this.__elfland.routerPromise.addCheck(this.check,this),this.__elfland.routerPromise.addCheck(this.checkQuery,this),this.__elfland.routerPromise.addPostcheck(this.postcheck,this)}async check(e,t){if(this.is(e,"ts-playground")&&!this.__tsFilesListIsGotten)try{await this.__elfland.data.waitingDataGet;const s=this.__elfland.data.data;if(s===null)return;const i=s.tsJsonList;this.__tsFilesList=Array.from(i),this.__tsFilesListPromise.resolve(),this.__tsFilesListIsGotten=!0}catch(s){console.error(s)}}async checkQuery(e,t){if(!this.is(e,"ts-playground"))return;const s=e.query.example;if(typeof s=="string"){if(await this.__tsFilesListPromise.promise,!this.__tsFilesList.includes(s))return{name:"ts-playground",query:{}};if(!this.__tsFiles.has(s)){const r=await(await fetch(`/data/ts-playground/${s}.json`)).json(),a={};r.forEach(o=>{a["/"+o.name]=o.code}),this.__tsFiles.set(s,a)}}}postcheck(e,t){if(!this.is(e,"ts-playground"))return;const s=e.query.example;typeof s!="string"?this.__selectedExample.value="def":this.__selectedExample.value=s}}const ai=`<!-- Try editing me! -->
<div id="app" class="p-4">
  <h1>Hello, Playground 👋</h1>
  <button id="btn">Click me</button>
</div>`,ni=`body{ font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, 
  "Apple Color Emoji", "Segoe UI Emoji"; padding: 16px;}
#btn{ padding: 8px 12px; border: 1px solid #ddd; border-radius: 8px; cursor: pointer;}
#btn:hover{ background:#f5f5f5; }`,oi=`console.log('Hello from JS!')
const btn = document.getElementById('btn')
btn?.addEventListener('click', ()=>{
  console.log('Button clicked at', new Date().toLocaleTimeString())
  alert('Hi from JS!')
})`,li=`type Person = { name: string, age: number }
const p: Person = { name: 'Alice', age: 20 }
console.info('TS compiled value:', p)`,ve={html:{name:"html",code:ai},css:{name:"css",code:ni},js:{name:"js",code:oi},ts:{name:"ts",code:li}};class ci extends j{__playgroundFilesListIsGotten=!1;__playgroundFilesListPromise=new Z;__playgroundFilesList=[];__playgroundFiles=new Map;__selectedExample=I("def");get selectedExampleFiles(){return D(()=>this.__playgroundFiles.get(this.__selectedExample.value)||ve)}constructor(e){super(e),this.__playgroundFiles.set("def",ve)}loadedCallback(){this.__elfland.routerPromise.addCheck(this.check,this),this.__elfland.routerPromise.addCheck(this.checkQuery,this),this.__elfland.routerPromise.addPostcheck(this.postcheck,this)}async check(e,t){if(this.is(e,"playground")&&!this.__playgroundFilesListIsGotten)try{await this.__elfland.data.waitingDataGet;const s=this.__elfland.data.data;if(s===null)return;const i=s.playgroundJsonList;this.__playgroundFilesList=Array.from(i),this.__playgroundFilesListPromise.resolve(),this.__playgroundFilesListIsGotten=!0}catch(s){console.error(s)}}async checkQuery(e,t){if(!this.is(e,"playground"))return;const s=e.query.example;if(typeof s=="string"){if(await this.__playgroundFilesListPromise.promise,!this.__playgroundFilesList.includes(s))return{name:"playground",query:{}};if(!this.__playgroundFiles.has(s)){const r=await(await fetch(`/data/playground/${s}.json`)).json(),a={html:{name:"html",code:""},css:{name:"css",code:""},ts:{name:"ts",code:""},js:{name:"js",code:""}};r.forEach(o=>{["html","css","ts","js"].includes(o.type)&&(a[o.type].name=o.name,a[o.type].code=o.code)}),this.__playgroundFiles.set(s,a)}}}postcheck(e,t){if(!this.is(e,"playground"))return;const s=e.query.example;typeof s!="string"?this.__selectedExample.value="def":this.__selectedExample.value=s}}class hi{name;url;avater;desc;constructor(e,t,s,i){this.name=e,this.url=t,this.avater=s,this.desc=i}}class ui extends j{__friendsIsGotten=!1;__friends=I([]);get friends(){return D(()=>this.__friends.value)}constructor(e){super(e)}loadedCallback(){this.__elfland.routerPromise.addCheck(this.check,this)}async check(e,t){if(!this.__friendsIsGotten)try{await this.__elfland.data.waitingDataGet;const s=this.__elfland.data.data;if(s===null)return;s.friends.forEach(r=>{this.__friends.value.push(new hi(r.name,r.url,r.avater,r.desc))}),this.__friendsIsGotten=!0}catch(s){console.error(s)}}}class Q extends j{static LANG="LANG";static LANG_LIST=["zh-CN","en-US"];i18n;langList=["zh-CN","en-US"];__lang;__watchFunc;constructor(e,t){super(t),this.__lang=I(this.getLangStr()),this.i18n=We({locale:this.__lang.value,legacy:!1,messages:e}),this.__watchFunc=J(this.__lang,s=>{this.setLangStr(s)})}loadedCallback(){}getLangStr(){let e=X(Q.LANG,"en-US")||"";return Q.LANG_LIST.includes(e)||(this.setLangStr("en-US"),e="en-US"),e}setLangStr(e){Y(Q.LANG,e),this.getLocale().value=e}getLang(){return this.__lang}getT(){const{t:e}=this.i18n.global;return e}getLocale(){return this.i18n.global.locale}getTe(){const{te:e}=this.i18n.global;return e}toggleLang(){this.__lang.value=this.__lang.value==="zh-CN"?"en-US":"zh-CN"}}class di extends K{__cubismModel=null;__expressionManager=null;__destroyed=!1;setCubismModel(e,t){this.__cubismModel=e,this.__expressionManager=t}pushExpressionData(e){this.__expressionManager&&this.__expressionManager.getExpressionIndex(e)===-1&&this.__expressionManager.definitions.push({Name:e,File:e})}addParameterValueById(e,t,s){this.__cubismModel&&this.__cubismModel.addParameterValueById(e,t,s)}multiplyParameterValueById(e,t,s){this.__cubismModel&&this.__cubismModel.multiplyParameterValueById(e,t,s)}setParameterValueById(e,t,s){this.__cubismModel&&this.__cubismModel.setParameterValueById(e,t,s)}getParameterIndex(e){return this.__cubismModel?this.__cubismModel.getParameterIndex(e):-1}getParameterValueById(e){return this.__cubismModel?this.__cubismModel.getParameterValueById(e):-1}saveParameters(){return this.__cubismModel?(this.__cubismModel.saveParameters(),!0):!1}loadParameters(){return this.__cubismModel?(this.__cubismModel.loadParameters(),!0):!1}destroy(){this.__destroyed||(this.__destroyed=!0,this.removeAllListeners())}}class mi extends di{static name="default";name;__model=null;__live2DFrom;__line2DModelConfig;__live2DParameterDatas=new Map;__live2DAllParameterDatas=new Map;__live2DExpressionDatas=new Map;__live2DActiveParameterDatas=new Map;__timer;__statusData={hitIgnore:!1};__idleStop=null;get costumes(){return Array.from(this.__costumes)}constructor(e,t){super(),this.name=t.name||"default",this.__live2DFrom=e,this.__line2DModelConfig=t,this.__timer=new ns,this.init()}init(){this.__timer.create("idle",!1,1e3*60*5),this.__timer.on("idle",()=>{this.__idleStop=this.idle()},this),this.__timer.restart("idle"),this.__line2DModelConfig.expressionDatas.forEach(e=>{this.__live2DExpressionDatas.set(e.id,e)}),this.__line2DModelConfig.parameterGroups.forEach(e=>{const t=new Map;e.parameterDatas.forEach(s=>{t.set(s.id,s),this.__live2DAllParameterDatas.set(s.id,s)}),this.__live2DParameterDatas.set(e.groupId,t)})}setHitIgnore(e){this.__statusData.hitIgnore=e}async load(e){return this.__model=await Je.from(this.__live2DFrom),this.__destroyed||this.__model===null||e.stage===null?!1:(e.stage.addChild(this.__model),this.setCubismModel(this.__model.internalModel.coreModel,this.__model.internalModel.motionManager.expressionManager),this.__model.on("hit",t=>{this.hitAreasBase(t)}),this.loaded(),this.emit("loaded"),!0)}destroy(){super.destroy(),this.__timer&&this.__timer.destroy(),this.__model&&this.__model.destroy()}changeParameterValue(e,t,s,i=!1){const r=this.__live2DParameterDatas.get(e);if(!r||i||!r.has(t))return!1;const a=r.get(t),o=this.__live2DActiveParameterDatas,c=o.get(e);return s?(c===t||((c!==void 0||a.parameterId==="NULL")&&this.changeParameterValue(e,"",!1,!0),a.parameterId==="NULL")||(o.set(e,t),a.blend==="Add"?this.addParameterValueById(a.parameterId,a.value,a.weight):this.multiplyParameterValueById(a.parameterId,a.value,a.weight)),!0):!i&&c!==t||c===void 0?!1:(o.delete(e),i||a.blend==="Add"?this.addParameterValueById(c,0,a.weight):this.multiplyParameterValueById(c,0,a.weight),!0)}addParameter(e,t){return this.changeParameterValue(e,t,!0)}removeParameter(e,t,s=!1){return this.changeParameterValue(e,t,!1,s)}addParameterOnlyForMap(e,t){const s=this.__live2DParameterDatas.get(e);if(!s||!s.has(t))return!1;const i=s.get(t);return this.__live2DActiveParameterDatas.set(e,i.id),!0}removeParameterOnlyForMap(e){return this.__live2DParameterDatas.has(e)?(this.__live2DActiveParameterDatas.delete(e),!0):!1}addExpression(e){if(console.log(e),this.__destroyed||!this.__model)return;const t=typeof e=="string"?this.__live2DExpressionDatas.get(e)?.parameterDatas:e;t!==void 0&&(e=t,Object.entries(e).forEach(([s,i])=>{i===null?this.removeParameterOnlyForMap(s):this.addParameterOnlyForMap(s,i)}),this.showExpression())}removeExpression(e,t=!1){const s=this.__live2DActiveParameterDatas;if(t){if(!Array.isArray(e))return;Object.entries(s).forEach(([i])=>{e.includes(i)||this.removeParameterOnlyForMap(i)})}else{const i=typeof e=="string"?this.__live2DExpressionDatas.get(e)?.parameterDatas:e;if(i===void 0||Array.isArray(i))return;i===null?Object.entries(s).forEach(([r,a])=>{this.removeParameterOnlyForMap(r)}):Object.entries(i).forEach(([r,a])=>{a===null?this.removeParameterOnlyForMap(r):this.removeParameterOnlyForMap(r)})}this.showExpression()}showExpression(){if(!this.__model)return;const e=this.createExpressionFileData();this.pushExpressionData(e.name),this.__model.expression(e.name,e.data)}createGroupList(){return this.__line2DModelConfig.parameterGroups.map(e=>e.groupId)}createExpressionFileData(){const t=this.createGroupList().map(i=>this.__live2DActiveParameterDatas.get(i)||"NULL");return{data:{Type:"Live2D Expression",Parameters:t.map(i=>{if(i==="NULL")return null;const r=this.__live2DAllParameterDatas.get(i);return r===void 0?null:{Id:r.parameterId,Value:r.value,Blend:r.blend}}).filter(i=>i!==null)},name:t.join("-")}}hitAreasBase(e){return this.__statusData.hitIgnore?(this.__statusData.hitIgnore=!1,!1):(this.__idleStop&&(this.__idleStop(),this.__idleStop=null),this.__timer.restart("idle"),this.hitAreas(e),this.emit("hitAreas",e),!0)}themeTo(e){e==="light"?this.addExpression("light"):this.addExpression("dark")}}const fi={name:"atri",parameterGroups:[{groupId:"主题",parameterDatas:[{id:"light",parameterId:"NULL",value:30,blend:"Add"},{id:"dark",parameterId:"Param10",value:30,blend:"Add"}]},{groupId:"着装",parameterDatas:[{id:"常服",parameterId:"NULL",value:0,blend:"Add"},{id:"睡衣",parameterId:"Param18",value:30,blend:"Add"},{id:"bikini",parameterId:"Param17",value:30,blend:"Add"},{id:"血衣",parameterId:"Param36",value:30,blend:"Add"}]},{groupId:"脸部表情",parameterDatas:[{id:"无表情",parameterId:"NULL",value:0,blend:"Add"},{id:"脸红",parameterId:"ParamCheek",value:30,blend:"Add"},{id:"高光消失",parameterId:"Param21",value:30,blend:"Add"},{id:"白眼",parameterId:"Param22",value:30,blend:"Add"},{id:"No",parameterId:"Param39",value:-30,blend:"Add"},{id:"Yes",parameterId:"Param39",value:30,blend:"Add"}]},{groupId:"待机",parameterDatas:[{id:"小鸟",parameterId:"Param37",value:30,blend:"Add"},{id:"螃蟹",parameterId:"Param38",value:30,blend:"Add"}]}],expressionDatas:[{id:"light",parameterDatas:{主题:"light"}},{id:"dark",parameterDatas:{主题:"dark"}},{id:"无表情",parameterDatas:{脸部表情:"无表情"}},{id:"害羞",parameterDatas:{脸部表情:"脸红"}},{id:"生气",parameterDatas:{脸部表情:"高光消失"}},{id:"变傻",parameterDatas:{脸部表情:"白眼"}},{id:"杀",parameterDatas:{着装:"血衣",脸部表情:"高光消失"}},{id:"好",parameterDatas:{脸部表情:"Yes"}},{id:"坏",parameterDatas:{脸部表情:"No"}}]},_i={url:"/static/live2D/atri/",Version:3,FileReferences:{Moc:"atri_8.moc3",Textures:["texture_00.png","texture_01.png"],Physics:"atri_8.physics3.json",DisplayInfo:"atri_8.cdi3.json",Expressions:[{Name:"test",File:"expressions/expressionsdark-blood-birds.exp3.json"}],Motions:{}},Groups:[{Target:"Parameter",Name:"EyeBlink",Ids:["ParamEyeLOpen","ParamEyeROpen"]},{Target:"Parameter",Name:"LipSync",Ids:["ParamMouthForm","ParamMouthOpenY"]}],HitAreas:[{Id:"HitArea",Name:"Body"},{Id:"HitArea2",Name:"Head"},{Id:"HitArea3",Name:"Face"}]};var Ce=(n=>(n.N="NoUseI18n",n.M="UseI18nForMessage",n.D="UseI18nForDollar",n.B="UseI18nForBoth",n))(Ce||{});const pi={html:{mouseenter:[["img","","alt",Ce.B,n=>n==="艾拉"?"我和艾拉哪个更高性能呢？":!1]]}};class gi extends mi{message=pi.html;__costumes=["常服","睡衣"];__quickClickFace;__quickClickFaceActive;__quickClickHead;__quickClickHeadActive;__quickClickBody;__quickClickBodyActive;__canChangeExpression=!0;__currentCostume="";constructor(){super(_i,fi),this.__quickClickFace=ie(),this.__quickClickFaceActive=!1,this.__quickClickHead=ie(),this.__quickClickHeadActive=!1,this.__quickClickBody=ie(400,8),this.__quickClickBodyActive=!1,this.__timer.create("expression",!1,5e3),this.__timer.on("expression",()=>{this.addExpression("无表情"),this.costumeTo(this.__currentCostume),this.__canChangeExpression=!0,this.__quickClickFaceActive=!1,this.__quickClickHeadActive=!1,this.__quickClickBodyActive=!1})}loaded(){if(this.__model===null)return;this.__model.x=-170,this.__model.y=10,this.__model.scale.set(.3);const e=ls([[0,7],[19,24]]),t=pe(1,100);this.__currentCostume=t?"bikini":e?"睡衣":"常服",this.costumeTo(this.__currentCostume)}setParameter(e,t){return this.setParameterValueById(e,t)}idle(){const e=pe(1,2)?"螃蟹":"小鸟";return this.addExpression({待机:e}),()=>{this.removeExpression({待机:e})}}hitAreas(e){if(e[0]==="Body"){if(this.__quickClickBodyActive)return;this.addExpression("坏"),this.restartTimerChangeToNoExpression(!0),this.__quickClickBody(()=>{this.__quickClickBodyActive=!0,this.addExpression("杀"),this.restartTimerChangeToNoExpression(!1)})}else if(e.indexOf("Face")!==-1){if(this.__quickClickFaceActive)return;this.addExpression("害羞"),this.restartTimerChangeToNoExpression(!0),this.__quickClickFace(()=>{this.__quickClickFaceActive=!0,this.addExpression("生气"),this.restartTimerChangeToNoExpression(!1)})}else{if(this.__quickClickHeadActive)return;this.addExpression("好"),this.restartTimerChangeToNoExpression(!0),this.__quickClickHead(()=>{this.__quickClickHeadActive=!0,this.addExpression("变傻"),this.restartTimerChangeToNoExpression(!1)})}}restartTimerChangeToNoExpression(e=!0,t=5e3){this.__canChangeExpression&&(this.__canChangeExpression=e,this.__timer.restart("expression",t))}costumeTo(e){return this.addExpression({着装:e}),!0}}class yi extends j{__app=null;__live2DModel=null;__watchHandle;constructor(e){super(e),this.__watchHandle=J(e.theme.theme,t=>{t==="light"?this.__live2DModel?.themeTo("light"):this.__live2DModel?.themeTo("dark")})}loadedCallback(){}show(e){this.__app=new gt(e)}async add(e){this.__app!==null&&(this.__live2DModel&&this.__live2DModel.destroy(),this.__live2DModel=e,await e.load(this.__app),this.__elfland.emit("live-2d-model-added"),this.__elfland.theme.theme.value==="light"?e.themeTo("light"):e.themeTo("dark"),this.__elfland.message.html.addMessage(e.name,e.message))}remove(){this.__live2DModel&&(this.__live2DModel.destroy(),this.__live2DModel=null,this.__elfland.emit("live-2d-model-removed"))}destroy(){this.__elfland.emit("live-2d-shower-destroy"),this.__watchHandle(),this.__live2DModel&&this.__live2DModel.destroy(),this.__app&&this.__app.destroy(),this.__elfland.emit("live-2d-shower-destroyed")}}class vi extends j{__selector;__key2message=new Map;constructor(e){super(e),this.__selector=e.selector}loadedCallback(){this.__selector.on("htmlMessage",e=>{console.log("htmlMessage",e)})}createSelectorDataList(e){const t=[];return Object.entries(e).forEach(([s,i])=>{i.forEach(r=>{t.push([s,r[0],"htmlMessage",{childrenEvent:!0}])})}),t}addMessage(e,t){this.removeMessage(e),this.__key2message.set(e,t),this.__selector.addSelectorList(this.createSelectorDataList(t))}removeMessage(e){const t=this.__key2message.get(e);t&&this.__selector.removeSelectorList(this.createSelectorDataList(t))}}class ki extends j{html;constructor(e){super(e),this.html=new vi(e)}loadedCallback(){}}class H extends K{static instance=null;static getInstance(e){return!H.instance&&e&&(H.instance=new H(e)),H.instance}routerPromise;theme;selector;message;i18n;about;friends;projects;data;articles;article;links;tags;categories;playground;tsPlayground;live2d;constructor(e){super(),this.routerPromise=new ts(e),this.theme=new W(this),this.selector=new is,this.message=new ki(this),this.i18n=new Q(es,this),this.about=new ii(this),this.friends=new ui(this),this.projects=new Xs(this),this.data=new cs(this),this.articles=new fs(this),this.article=new Ws(this),this.links=new ps(this),this.tags=new ei(this),this.categories=new ti(this),this.playground=new ci(this),this.tsPlayground=new ri(this),this.live2d=new yi(this),this.emit("loaded")}}function bi(){return H.getInstance()}class wi{audio;ctx;srcNode;analyser;kAnalyser;hp;hs;freqDb;timeBuf;kTimeBuf;freqHz;get src(){return this.srcNode}constructor(e={}){const{element:t,src:s,fftSize:i=4096,kFftSize:r=16384,smoothingTimeConstant:a=.8,monitorOutput:o=!0,crossOrigin:c="anonymous",volume:h=1}=e;if(this.audio=t??document.createElement("audio"),this.audio.preload="auto",this.audio.loop=!1,this.audio.controls=!1,this.audio.volume=h,!t&&s)c&&(this.audio.crossOrigin=c),this.audio.src=s;else if(!t&&!s)throw new Error("Provide either opts.element or opts.src");this.ctx=new(window.AudioContext||window.webkitAudioContext),this.srcNode=this.ctx.createMediaElementSource(this.audio),this.analyser=this.ctx.createAnalyser(),this.analyser.fftSize=i,this.analyser.smoothingTimeConstant=a,this.hp=this.ctx.createBiquadFilter(),this.hp.type="highpass",this.hp.frequency.value=60,this.hp.Q.value=.5,this.hs=this.ctx.createBiquadFilter(),this.hs.type="highshelf",this.hs.frequency.value=4e3,this.hs.gain.value=4,this.kAnalyser=this.ctx.createAnalyser(),this.kAnalyser.fftSize=r,this.kAnalyser.smoothingTimeConstant=0,this.srcNode.connect(this.analyser),this.srcNode.connect(this.hp),this.hp.connect(this.hs),this.hs.connect(this.kAnalyser),o&&this.srcNode.connect(this.ctx.destination),this.freqDb=new Float32Array(this.analyser.frequencyBinCount),this.timeBuf=new Float32Array(this.analyser.fftSize),this.kTimeBuf=new Float32Array(this.kAnalyser.fftSize);const d=this.analyser.frequencyBinCount,y=this.ctx.sampleRate,b=new Float32Array(d),N=y/this.analyser.fftSize;for(let P=0;P<d;P++)b[P]=P*N;this.freqHz=b}async resume(){this.ctx.state==="suspended"&&await this.ctx.resume()}async load(e){this.audio.src!==e&&(this.audio.src=e),await this.audio.load()}async play(){await this.resume(),await this.audio.play()}pause(){this.audio.pause()}setVolume(e){this.audio.volume=Math.max(0,Math.min(1,e))}getSpectrum(){return this.analyser.getFloatFrequencyData(this.freqDb),{db:this.freqDb,freqHz:this.freqHz}}getWaveform(){return this.analyser.getFloatTimeDomainData(this.timeBuf),{samples:this.timeBuf,durationSec:this.timeBuf.length/this.ctx.sampleRate}}getLoudness(){this.analyser.getFloatTimeDomainData(this.timeBuf);let e=0,t=0;for(let h=0;h<this.timeBuf.length;h++){const d=this.timeBuf[h];e+=d*d;const y=Math.abs(d);y>t&&(t=y)}const s=Math.sqrt(e/this.timeBuf.length),i=20*Math.log10(Math.max(s,1e-12));this.kAnalyser.getFloatTimeDomainData(this.kTimeBuf);let r=0;for(let h=0;h<this.kTimeBuf.length;h++){const d=this.kTimeBuf[h];r+=d*d}const a=Math.sqrt(r/this.kTimeBuf.length),c=20*Math.log10(Math.max(a,1e-12))+2.3;return{rmsDbfs:i,peak:t,lufsApprox:c}}destroy(){try{this.srcNode.disconnect(),this.analyser.disconnect(),this.hp.disconnect(),this.hs.disconnect(),this.kAnalyser.disconnect()}catch(e){console.error(e)}try{this.ctx.state!=="closed"&&this.ctx.close()}catch(e){console.error(e)}}}class Di{constructor(e,t,s,i={}){this.setParam=s,this.ctx=e,this.srcNode=t,this.conf={hpHz:200,lpHz:4e3,attackMs:30,releaseMs:120,gateDbfs:-55,inMinDbfs:-50,inMaxDbfs:-15,outMin:.05,outMax:1,vocalRatioThresh:.25,flatnessThresh:.5,holdMsWhenVocal:120,mouthOpenParam:"ParamMouthOpenY",mouthFormParam:"ParamMouthForm",...i},this.hp=e.createBiquadFilter(),this.hp.type="highpass",this.hp.frequency.value=this.conf.hpHz,this.lp=e.createBiquadFilter(),this.lp.type="lowpass",this.lp.frequency.value=this.conf.lpHz,this.analyserVocal=e.createAnalyser(),this.analyserVocal.fftSize=2048,this.analyserVocal.smoothingTimeConstant=.5,this.srcNode.connect(this.hp),this.hp.connect(this.lp),this.lp.connect(this.analyserVocal),this.analyserFull=e.createAnalyser(),this.analyserFull.fftSize=2048,this.analyserFull.smoothingTimeConstant=.5,this.srcNode.connect(this.analyserFull),this.beatLP=e.createBiquadFilter(),this.beatLP.type="lowpass",this.beatLP.frequency.value=150,this.analyserBeat=e.createAnalyser(),this.analyserBeat.fftSize=1024,this.analyserBeat.smoothingTimeConstant=.8,this.srcNode.connect(this.beatLP),this.beatLP.connect(this.analyserBeat),this.specFull=new Float32Array(this.analyserFull.frequencyBinCount),this.specVocal=new Float32Array(this.analyserVocal.frequencyBinCount),this.timeVocal=new Float32Array(this.analyserVocal.fftSize)}ctx;srcNode;analyserFull;analyserVocal;hp;lp;beatLP;analyserBeat;specFull;specVocal;timeVocal;conf;mouthSmoothed=0;lastUpdateTime=0;lastVocalTime=0;vocalPresent=!1;update(){const e=this.ctx.currentTime,t=this.lastUpdateTime?Math.max(0,e-this.lastUpdateTime):0;this.lastUpdateTime=e,this.analyserVocal.getFloatTimeDomainData(this.timeVocal),this.analyserVocal.getFloatFrequencyData(this.specVocal),this.analyserFull.getFloatFrequencyData(this.specFull);let s=0;for(let M=0;M<this.timeVocal.length;M++){const _=this.timeVocal[M];s+=_*_}const i=Math.sqrt(s/this.timeVocal.length),r=20*Math.log10(Math.max(i,1e-12)),a=this.dbToLinArray(this.specVocal),o=this.dbToLinArray(this.specFull),c=ke(a),h=ke(o)+1e-12,d=c/h,y=Si(a);if(d>this.conf.vocalRatioThresh&&y<this.conf.flatnessThresh)this.vocalPresent=!0,this.lastVocalTime=e;else{const M=this.conf.holdMsWhenVocal/1e3;e-this.lastVocalTime>M&&(this.vocalPresent=!1)}let N=0;if(this.vocalPresent&&r>this.conf.gateDbfs){const M=z((r-this.conf.inMinDbfs)/(this.conf.inMaxDbfs-this.conf.inMinDbfs));N=this.conf.outMin+(this.conf.outMax-this.conf.outMin)*Math.sqrt(M)}else N=.05;const P=this.conf.attackMs/1e3,p=this.conf.releaseMs/1e3;if(N>this.mouthSmoothed){const M=1-Math.exp(-t/Math.max(P,1e-4));this.mouthSmoothed+=(N-this.mouthSmoothed)*M}else{const M=1-Math.exp(-t/Math.max(p,1e-4));this.mouthSmoothed+=(N-this.mouthSmoothed)*M}const T=this.estimateMouthForm(this.specVocal,this.analyserVocal);this.setParam(this.conf.mouthOpenParam,z(this.mouthSmoothed)),this.conf.mouthFormParam&&this.setParam(this.conf.mouthFormParam,z(T));const A=this.getBeatEnergy();return{mouthOpen:z(this.mouthSmoothed),vocal:this.vocalPresent,beat:A}}dbToLinArray(e){const t=new Float32Array(e.length);for(let s=0;s<e.length;s++)t[s]=Math.pow(10,e[s]/10);return t}estimateMouthForm(e,t){const s=this.dbToLinArray(e),r=this.ctx.sampleRate/t.fftSize;let a=0,o=0;for(let d=0;d<s.length;d++){const y=d*r;a+=y*s[d],o+=s[d]}const h=((o>0?a/o:0)-500)/2500;return z(h)}getBeatEnergy(){const e=new Float32Array(this.analyserBeat.frequencyBinCount);this.analyserBeat.getFloatFrequencyData(e);const s=this.ctx.sampleRate/this.analyserBeat.fftSize,i=Math.floor(30/s),r=Math.min(Math.floor(120/s),e.length-1);let a=0;for(let o=i;o<=r;o++)a+=Math.pow(10,e[o]/10);return z(Math.sqrt(a)*3)}}function z(n){return Math.max(0,Math.min(1,n))}function ke(n){let e=0;for(let t=0;t<n.length;t++)e+=n[t];return e}function Si(n){let e=0,t=0;const s=n.length,i=1e-12;for(let r=0;r<s;r++){const a=Math.max(n[r],i);e+=Math.log(a),t+=a}return e=Math.exp(e/s),t=t/s+i,z(e/t)}const Mi=De({__name:"index",props:{pos:{default:()=>({left:"0",top:"0",right:"none",bottom:"none"}),type:Object},dragable:{default:!0,type:Boolean},direction:{default:"xy",type:String}},setup(n){const e=n,s=bi().live2d,i=new gi,r=I(null),a=I(null),o=I(null),c=I(""),h=I(""),d=I(0),y=I(0),b=I(!1),N=D(()=>c.value||e.pos.left),P=D(()=>c.value!==""?"none":e.pos.right),p=D(()=>h.value||e.pos.top),T=D(()=>h.value!==""?"none":e.pos.bottom),A=D(()=>e.direction.toLocaleLowerCase()),M=l=>{l.target===r.value&&e.dragable&&(d.value=l.offsetX,y.value=l.offsetY,b.value=!0,window.addEventListener("mousemove",_),window.addEventListener("mouseup",m))},_=l=>{if(b.value&&o.value){const u=o.value.getBoundingClientRect().width,g=o.value.getBoundingClientRect().height,E=l.clientX-d.value,k=l.clientY-y.value;let w=Math.max(0,Math.min(E,window.innerWidth-u)).toString()+"px",C=Math.max(0,Math.min(k,window.innerHeight-g)).toString()+"px";A.value.indexOf("x")===-1&&(w=""),A.value.indexOf("y")===-1&&(C=""),c.value=w,h.value=C,i.setHitIgnore(!0)}},m=()=>{b.value=!1,window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",m)};Xe(async()=>{r.value&&a.value&&(s.show({view:r.value,autoStart:!0,resizeTo:a.value,backgroundAlpha:0}),await s.add(i))}),Ze(()=>{s.destroy()});const v=new wi({src:"/static/audio/nygs-2.mp3",fftSize:4096,kFftSize:16384,smoothingTimeConstant:.8,crossOrigin:"anonymous",monitorOutput:!0,volume:.05}),f=(l,u)=>{i.setParameter(l,u)};new Di(v.ctx,v.src,f,{gateDbfs:-55,inMinDbfs:-50,inMaxDbfs:-15,attackMs:25,releaseMs:110,mouthOpenParam:"ParamMouthOpenY",mouthFormParam:"ParamMouthForm"});const S=async()=>{};return(l,u)=>(Me(),Se("div",{ref_key:"container",ref:o,class:"live2d-container select-none",style:et({"--left":N.value,"--right":P.value,"--top":p.value,"--bottom":T.value}),onMousedown:M,onClick:S},[de("div",{ref_key:"canvasContainer",ref:a,class:"live2d-canvas-container"},[de("canvas",{ref_key:"canvas",ref:r},null,512)],512)],36))}}),Ti=De({__name:"App",setup(n){const e=window.innerWidth;return(t,s)=>{const i=tt("router-view");return Me(),Se("div",null,[me(i),me(Mi,{pos:{right:`${Math.max(0,st(e)/2-1e3)}px`,bottom:"0"},direction:"x"},null,8,["pos"])])}}}),Ei="modulepreload",Ci=function(n){return"/"+n},be={},q=function(e,t,s){let i=Promise.resolve();if(t&&t.length>0){let c=function(h){return Promise.all(h.map(d=>Promise.resolve(d).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");i=c(t.map(h=>{if(h=Ci(h),h in be)return;be[h]=!0;const d=h.endsWith(".css"),y=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${y}`))return;const b=document.createElement("link");if(b.rel=d?"stylesheet":Ei,d||(b.as="script"),b.crossOrigin="",b.href=h,o&&b.setAttribute("nonce",o),document.head.appendChild(b),d)return new Promise((N,P)=>{b.addEventListener("load",N),b.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${h}`)))})}))}function r(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&r(o.reason);return e().catch(r)})};oe.configure({showSpinner:!1});const ee=it({history:rt("/"),routes:[{path:"/",name:"home",component:()=>q(()=>import("./index-DXjaoGI0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))},{path:"/archives",name:"archives",component:()=>q(()=>import("./index-Bsqk1qzD.js"),__vite__mapDeps([14,10,2,3,4,5,6,15,1,7,8,9,11,12,13]))},{path:"/categories",name:"categories",component:()=>q(()=>import("./index-DRljjcBF.js"),__vite__mapDeps([16,2,3,4,5,6,10,15,1,7,8,9,11,12,13]))},{path:"/tags",name:"tags",component:()=>q(()=>import("./index-DmDnxAE8.js"),__vite__mapDeps([17,2,3,4,5,6,10,15,1,7,8,9,11,12,13]))},{path:"/diagram",name:"diagram",component:()=>q(()=>import("./index-CX77IQZr.js"),__vite__mapDeps([18,1,2,3,4,5,6,7,8,11,12,13]))},{path:"/search",name:"search",component:()=>q(()=>import("./AboutView-CcMYqCNL.js"),__vite__mapDeps([19,7,2,3,4,5,6]))},{path:"/blog/:articlePath",name:"article",component:()=>q(()=>import("./index-B6WC_k1I.js"),__vite__mapDeps([20,1,2,3,4,5,6,7,8,9,11,12,13]))},{path:"/about",name:"about",component:()=>q(()=>import("./AboutView-CcMYqCNL.js"),__vite__mapDeps([19,7,2,3,4,5,6]))},{path:"/playground",name:"playground",component:()=>q(()=>import("./index-DSAeinf7.js"),__vite__mapDeps([21,22,1,2,3,4,5,6,7,8,23,11,12,13]))},{path:"/ts-playground",name:"ts-playground",component:()=>q(()=>import("./index-ClHk7wyn.js"),__vite__mapDeps([24,22,1,2,3,4,5,6,7,8,23,11,12,13,25]))},{path:"/:pathMatch(.*)*",name:"404",redirect:"/"}]}),ne=H.getInstance(ee);ee.beforeEach(async(n,e,t)=>{oe.start(),ne.routerPromise.precheck(n,e,t)&&await ne.routerPromise.check(n,e,t)&&t()});ee.afterEach((n,e,t)=>{ne.routerPromise.postcheck(n,e),oe.done()});window.PIXI=at;const xe=nt(Ti);xe.use(ee);xe.mount("#app");export{ms as A,ce as C,Js as P,Zs as T,q as _,ae as a,ji as d,Oi as f,fe as m,bi as u};
//# sourceMappingURL=index-xOQeeRiY.js.map
